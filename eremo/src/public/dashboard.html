<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="images/logo.png" type="image/x-icon">
    <title>Admin Dashboard - Eremo frate Francesco</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Roboto:wght@300;400;500;700&family=Segoe+UI:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Stili Esistenti da dashboard.html (parzialmente mostrati per brevità) */
        :root {
            --primary: #365e51;
            --secondary: #8db187;
            --accent: #d18c60;
            --light: #f8f5ef;
            --dark: #1e3b2f;
            --dark-rgb: 30, 59, 47;
            --white: #ffffff;
            --gray-light: #e9e9e9;
            --gray-medium: #cccccc;
            --gray-dark: #555555;
            --danger: #e74c3c;
            --danger-rgb: 231, 76, 60;
            --success: #2ecc71;
            --success-rgb: 46, 204, 113;
            --primary-dark: #2a4b40; /* Aggiunto per coerenza con stili eventiincorso */
            --primary-light: #a5c2b9; /* Aggiunto */
            --primary-lighter: #eef3f1; /* Aggiunto */
            --secondary-rgb: 141, 177, 135; /* Aggiunto */
            --background-light: #f8f9fa; /* Aggiunto */
            --success-dark: #155724; /* Aggiunto */
            --success-light: #d4edda; /* Aggiunto */
            --danger-dark: #721c24; /* Aggiunto */
            --danger-light: #f8d7da; /* Aggiunto */

            --warning: #f39c12;
            --info: #3498db;
            --shadow-light: 0 6px 20px rgba(0, 0, 0, 0.09);
            --shadow-medium: 0 10px 38px rgba(0, 0, 0, 0.13);
            --shadow-strong: 0 10px 30px rgba(0,0,0,0.2); /* Aggiunto */
            --shadow-medium-strong: 0 8px 25px rgba(0,0,0,0.12); /* Aggiunto */
            --border-radius-small: .25rem;
            --border-radius-medium: 15px;
            --border-radius-large: 24px;
            --transition-fast: all 0.2s ease-in-out;
            --transition-duration-medium: 0.3s;
            --transition-timing-medium: ease-in-out;
            --transition-medium: all var(--transition-duration-medium) var(--transition-timing-medium);
            --navbar-height: 80px;
        }

        html, body { overflow-x: hidden; }
        body { background-color: var(--light); color: var(--dark); line-height: 1.9; font-size: 22px; display: flex; flex-direction: column; min-height: 100vh; }
        main { flex-grow: 1; padding-top: var(--navbar-height); width: 100%; }
        h1, h2, h3, h4, h5, h6 { color: var(--primary); margin-bottom: 1.5rem; font-weight: 600; line-height: 1.5; }
        h1 { font-size: clamp(2.8rem, 5.8vw, 3.5rem); }
        h2 { font-size: clamp(2.3rem, 4.8vw, 2.9rem); }
        h3 { font-size: clamp(1.8rem, 3.8vw, 2.1rem); }
        h4 { font-size: clamp(1.45rem, 3.2vw, 1.7rem); }
        p { margin-bottom: 1.4rem; font-size: 1.25rem; }
        a { color: var(--secondary); text-decoration: none; transition: var(--transition-fast); }
        a:hover { color: var(--accent); text-decoration: none; }
        img { max-width: 100%; height: auto; display: block; }

        .container { max-width: 1400px; width: 97%; margin-left: auto; margin-right: auto; padding-left: 25px; padding-right: 25px; }
        .section-padding { padding-top: clamp(1.2rem, 3vw, 2rem); padding-bottom: clamp(1.2rem, 3vw, 2rem); }
        .text-center { text-align: center !important; }

        .navbar-container { position: fixed; top: 0; left: 0; width: 100%; background: var(--primary); box-shadow: var(--shadow-medium); z-index: 1000; transition: transform 0.3s ease-in-out; height: var(--navbar-height); display: flex; align-items: center; }
        .navbar-container.hidden { transform: translateY(-100%); }
        .navbar { display: flex; align-items: center; justify-content: space-between; color: var(--white); max-width: 1400px; width: 97%; margin: 0 auto; }
        .navbar .logo { display: flex; align-items: center; gap: 1rem; }
        .navbar .logo a { color: var(--white); text-decoration: none; display: flex; align-items: center; gap: 1rem; }
        .navbar .logo a:hover { text-decoration: none; opacity: 0.9; }
        .navbar .logo h2 { color: var(--white); font-size: clamp(1.4rem, 3.4vw, 1.7rem); margin: 0; font-weight: 600; }
        .navbar .logo .emoji { font-size: 2rem; }
        .navbar .right-menu { display: flex; align-items: center; gap: 1.4rem; }
        .navbar .login-btn, .navbar .user-btn { background: rgba(255, 255, 255, 0.1); color: var(--white); padding: 0.8rem 1.4rem; border-radius: 10px; font-size: 1.15rem; font-weight: 500; border: 1px solid rgba(255, 255, 255, 0.2); transition: var(--transition-fast); cursor: pointer; white-space: nowrap; display: inline-flex; align-items: center; justify-content: center; }
        .navbar .login-btn:hover, .navbar .user-btn:hover { background: rgba(255, 255, 255, 0.2); transform: translateY(0px); box-shadow: none; text-decoration: none; }
        .hamburger { display: none !important; /* Nascondi hamburger come da dashboard.html */ }
        .mobile-menu { display: flex; flex-direction: column; position: fixed; top: var(--navbar-height); left: 0; width: 100%; height: auto; background: var(--primary); border-top: 1px solid rgba(255, 255, 255, 0.1); overflow-y: auto; opacity: 0; visibility: hidden; transform: translateY(0%); transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease; z-index: 999; }
        .mobile-menu.open { opacity: 1; visibility: visible; transform: translateX(0%); }
        .mobile-menu a { color: var(--white); padding: 1.4rem 2rem; font-size: 1.3rem; border-bottom: 1px solid rgba(255, 255, 255, 0.05); text-decoration: none; transition: background-color var(--transition-fast); }
        .mobile-menu a:last-child { border-bottom: none; }
        .mobile-menu a:hover, .mobile-menu a.active { background-color: rgba(255, 255, 255, 0.1); text-decoration: none; }
        .user-dropdown { position: relative; display: inline-block; }
        .user-dropdown .user-btn { display: flex; align-items: center; gap: 0.6rem; }
        .user-dropdown .dropdown-menu { display: none; position: absolute; right: 0; top: calc(100% + 11px); background-color: var(--white); min-width: 240px; box-shadow: 0 8.5px 25px rgba(0,0,0,0.15); z-index: 1001; border-radius: 11px; overflow: hidden; border: 1px solid var(--gray-light); }
        .user-dropdown .dropdown-menu a { color: var(--dark); padding: 1rem 1.4rem; text-decoration: none; display: block; font-size: 1.2rem; white-space: nowrap; transition: background-color var(--transition-fast), color var(--transition-fast); }
        .user-dropdown .dropdown-menu a:hover { background-color: var(--light); color: var(--primary); }
        .user-dropdown .dropdown-menu a:last-child { border-top: 1px solid var(--gray-light); color: var(--danger); }
        .user-dropdown .dropdown-menu a:last-child:hover { background-color: rgba(var(--danger-rgb), 0.11); color: #a71d2a; }
        .user-dropdown.show .dropdown-menu { display: block; animation: fadeInDropdown 0.2s ease-out; }
        @keyframes fadeInDropdown { from { opacity: 0; transform: translateY(-8px); } to { opacity: 1; transform: translateY(0); } }
        .user-dropdown .dropdown-arrow { font-size: 0.9rem; transition: transform var(--transition-fast); }
        .user-dropdown.show .dropdown-arrow { transform: rotate(180deg); }

        body.page-dashboard { background-color: var(--light); }
        body.page-dashboard main.dashboard-main { padding-top: calc(var(--navbar-height) + 1.5rem); padding-left: 1.5rem; padding-right: 1.5rem; padding-bottom: 2.5rem; }
        body.page-dashboard main.dashboard-main h1 { color: var(--primary); margin-bottom: 2rem; text-align: center; margin-top: 0; font-size: clamp(1.8rem, 3.5vw, 2.4rem); display: flex; align-items: center; justify-content: center; }
        body.page-dashboard main.dashboard-main h1 i { margin-right: 0.8rem; font-size: 0.9em; color: var(--secondary); }
        .dashboard-section { background-color: var(--white); padding: 1.5rem; border-radius: var(--border-radius-medium); box-shadow: var(--shadow-light); margin-bottom: 2rem; }
        .dashboard-section h2 { color: var(--secondary); margin-top: 0; margin-bottom: 1.5rem; border-bottom: 1px solid var(--gray-light); padding-bottom: 1rem; font-size: 1.6rem; text-align: left; display: flex; align-items: center; }
        .dashboard-section h2 i { margin-right: 0.6rem; font-size: 1em; }
        
        .form-message { padding: 0.75rem 1.25rem; margin-bottom: 1rem; border: 1px solid transparent; border-radius: var(--border-radius-small, .25rem); font-size: 0.95rem; }
        .form-message.success { color: var(--success-dark, #155724); background-color: var(--success-light, #d4edda); border-color: var(--success, #c3e6cb); }
        .form-message.error { color: var(--danger-dark, #721c24); background-color: var(--danger-light, #f8d7da); border-color: var(--danger, #f5c6cb); }
        
        .spinner-mini, .spinner-mini-light { display: inline-block; width: 1em; height: 1em; border-radius: 50%; animation: spin 0.8s linear infinite; vertical-align: middle; }
        .spinner-mini-light { border: 2px solid rgba(255, 255, 255, 0.3); border-top-color: #fff; margin-left: 5px; }
        .spinner-mini { border: 2px solid rgba(0,0,0,0.2); border-top-color: var(--primary); margin-right: 5px; }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        .btn-popup .spinner-mini { border-top-color: #fff; } /* Specifico per spinner su bottoni popup */
        .btn-admin .spinner-mini { border-top-color: var(--primary-dark, #2c4a43); }
        button:disabled .spinner-mini { border-top-color: #ccc; }

        .event-controls-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 0 !important; flex-wrap: wrap; position: relative; }
        .event-tabs-container-main { display: flex; flex-grow: 1; align-items: flex-end; }
        .filter-trigger-container-main { position: relative; margin-left: auto; align-self: flex-end; display: inline-block; }
        .event-controls-header .event-tab-button { padding: 0.9rem 1.5rem; font-size: 1rem; font-weight: 500; color: var(--gray-dark); background-color: var(--gray-light); border: 1px solid var(--gray-medium); border-bottom: none; cursor: pointer; transition: color 0.2s ease, background-color 0.2s ease, border-color 0.2s ease; display: inline-flex; align-items: center; gap: 0.5em; line-height: 1.4; text-align: center; justify-content: center; margin-right: -1px; }
        .event-controls-header .event-tab-button:hover { background-color: #e0e0e0; color: var(--primary); }
        .event-controls-header .event-tab-button.active { color: var(--primary); background-color: var(--white); border-color: var(--gray-medium) var(--gray-medium) var(--white); font-weight: 600; position: relative; z-index: 2; }
        .event-controls-header .event-tab-button.active i { color: var(--accent); }
        .event-tabs-container-main .event-tab-button { border-radius: 0; border-right: none; }
        .event-tabs-container-main .event-tab-button:first-child { border-top-left-radius: 10px; }
        .event-tabs-container-main > .event-tab-button:last-of-type { border-top-right-radius: 10px; border-right: 1px solid var(--gray-medium); }
        .filter-trigger-container-main #filterToggleButton.event-tab-button { border-top-left-radius: 10px; border-top-right-radius: 10px; margin-right: 0; border-left: 1px solid var(--gray-medium); margin-left: 8px; }
        .filter-trigger-container-main #filterToggleButton.event-tab-button.active { border-bottom-color: var(--white); }
        .dropdown-arrow-filter { margin-left: 0.5em; font-size: 0.8em; transition: transform 0.2s ease-in-out; }
        #filterToggleButton.active .dropdown-arrow-filter { transform: rotate(180deg); }
        .filter-panel { display: none; position: absolute; top: calc(100% - 1px); right: 0; left: auto; z-index: 100; background-color: var(--white); border: 1px solid var(--gray-medium); border-top: none; box-shadow: var(--shadow-medium); padding: 1.5rem; width: 320px; max-width: calc(100vw - 20px); box-sizing: border-box; border-radius: 0 0 var(--border-radius-medium) var(--border-radius-medium); }
        .filter-panel.active { display: block; animation: fadeInDropdown 0.2s ease-out; }
        .filter-panel h4 { margin-top: 0; margin-bottom: 1.2rem; font-size: 1.1rem; color: var(--primary); border-bottom: 1px solid var(--gray-light); padding-bottom: 0.6rem; text-align: left; }
        .filter-panel .form-group { margin-bottom: 1rem; }
        .filter-panel .form-group label { text-align: left; }
        .filter-panel .filter-panel-actions { margin-top: 1.5rem; display: flex; justify-content: space-between; gap: 0.5rem; }
        .filter-panel .filter-panel-actions .btn-admin { flex-grow: 1; }
        .filter-panel-actions .btn-admin i { margin-right: 0.3em; }
        .event-view-controls { display: flex; flex-wrap: wrap; gap: 1rem 1.5rem; padding: 1rem 1.5rem; background-color: var(--white); border: 1px solid var(--gray-medium); border-top: none; margin-bottom: 1.5rem; border-radius: 0 0 var(--border-radius-medium) var(--border-radius-medium); box-shadow: var(--shadow-light); position: relative; z-index: 1; margin-top: -1px; }
        .event-view-controls .form-group { flex-grow: 1; flex-basis: 180px; min-width: 160px; }
        .event-view-controls label { font-size: 0.85rem; margin-bottom: 0.3rem; color: var(--primary); display: block; font-weight: 500; text-align: left; }
        .event-view-controls select.form-control { width: 100%; padding: 0.6rem 0.8rem; border: 1px solid var(--gray-medium); border-radius: 6px; font-size: 0.9rem; background-color: var(--white); line-height: 1.4; appearance: none; -webkit-appearance: none; -moz-appearance: none; background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23365e51%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.4-5.4-12.8z%22%2F%3E%3C%2Fsvg%3E'); background-repeat: no-repeat; background-position: right 0.6rem center; background-size: 0.6em auto; padding-right: 2rem; cursor: pointer; }
        .event-view-controls select.form-control:focus { border-color: var(--secondary); box-shadow: 0 0 0 3px rgba(var(--secondary-rgb, 141, 177, 135), 0.25); outline: none; }
        
        footer { background: var(--dark); color: var(--light); padding: 3rem 2.2rem; text-align: center; margin-top: auto; font-size: 1.15rem; }
        footer p { margin: 0; opacity: 0.7; text-align: center; }
        .btn-admin { padding: 0.6rem 1.2rem; border-radius: var(--border-radius-medium); font-size: 0.9rem; font-weight: 500; cursor: pointer; transition: var(--transition-medium); border: 1px solid transparent; text-align: center; text-decoration: none; display: inline-flex; align-items: center; justify-content: center; gap: 0.4em; line-height: 1.3; }
        .btn-admin:hover { transform: translateY(-2px); box-shadow: var(--shadow-light); }
        .btn-admin i.fas { line-height: 1; }
        .btn-admin.btn-admin-primary { background-color: var(--primary); color: var(--white); border-color: var(--primary); }
        .btn-admin.btn-admin-primary:hover { background-color: var(--dark); border-color: var(--dark); }
        .btn-admin.btn-admin-secondary { background-color: var(--secondary); color: var(--white); border-color: var(--secondary); }
        .btn-admin.btn-admin-secondary:hover { background-color: var(--primary); border-color: var(--primary); }
        .btn-admin.btn-admin-danger { background-color: var(--danger); color: var(--white); border-color: var(--danger); }
        .btn-admin.btn-admin-danger:hover { background-color: #c0392b; border-color: #b92c1c; }
        .btn-admin.btn-admin-warning { background-color: var(--warning); color: var(--dark); border-color: var(--warning); }
        .btn-admin.btn-admin-warning:hover { background-color: #e67e22; border-color: #d35400; }
        .btn-admin.btn-admin-info { background-color: var(--info); color: var(--white); border-color: var(--info); }
        .btn-admin.btn-admin-info:hover { background-color: #2980b9; border-color: #2471a3; }
        .btn-admin.btn-sm { padding: 0.35rem 0.7rem; font-size: 0.8rem; gap: 0.25em; }
        .btn-admin.btn-sm i.fas { font-size: 0.9em; }
        .modal { display: none; position: fixed; z-index: 1050; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(var(--dark-rgb), 0.84); backdrop-filter: blur(5px); transition: opacity 0.2s ease-out; align-items: center; justify-content: center; }
        .modal.active { display: flex; opacity: 1; }
        .modal-content { background-color: var(--white); padding: 2.4rem 3rem; border: none; width: 90%; max-width: 660px; border-radius: var(--border-radius-medium); position: relative; box-shadow: 0 11px 38px rgba(0,0,0,0.15); max-height: 90vh; display: flex; flex-direction: column; }
        .close-modal-btn { color: var(--gray-medium); position: absolute; top: 1.1rem; right: 1.1rem; font-size: 2.4rem; font-weight: bold; cursor: pointer; line-height: 1; padding: 0.32rem; transition: var(--transition-fast); z-index: 10; }
        .close-modal-btn:hover, .close-modal-btn:focus { color: var(--dark); transform: rotate(90deg) scale(1.12); }
        .modal-content-scrollable { overflow-y: auto; flex-grow: 1; padding: 0.5rem; min-height: 150px; }
        .modal-content h3 { color: var(--primary); font-size: 1.7rem; margin-bottom: 1.5rem; }
        .modal-content .form-group { margin-bottom: 1rem; }
        .modal-content .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--dark); font-size: 1rem; text-align: left; }
        .modal-content .form-group input[type="file"], .modal-content .form-group textarea, .modal-content .form-group input[type="text"] { width: 100%; padding: 0.8rem 1rem; border: 1px solid var(--gray-medium); border-radius: var(--border-radius-medium); font-size: 1rem; box-sizing: border-box; }
        .modal-content .form-group input[type="file"] { padding: 0.6rem; }
        .modal-content .form-group textarea { min-height: 80px; resize: vertical; }
        .modal-content form button[type="submit"].btn-admin { margin-top: 1rem; width: auto; display: block; margin-left: auto; margin-right: auto; }
        .modal-content .form-actions { margin-top: 1.5rem; text-align: right; }
        .modal-content .form-actions .btn-admin { margin-left: 0.5rem; }
        .existing-media-section { margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--gray-light); }
        .existing-media-section h4 { margin-bottom: 1rem; font-size: 1.1rem; color: var(--primary); font-weight: 500; }
        .existing-media-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 0.8rem; max-height: 300px; overflow-y: auto; padding: 0.5rem; background-color: var(--light); border-radius: 8px; border: 1px solid var(--gray-light); }
        .existing-media-item { border: 1px solid var(--gray-medium); padding: 0.75rem; border-radius: 8px; background-color: var(--white); text-align: center; font-size: 0.8rem; display: flex; flex-direction: column; justify-content: space-between; box-shadow: var(--shadow-light); transition: var(--transition-fast); }
        .existing-media-item:hover { box-shadow: var(--shadow-medium); transform: translateY(-2px); }
        .existing-media-item img, .existing-media-item video { width: 100%; height: 70px; object-fit: cover; margin-bottom: 0.5rem; border-radius: 4px; border: 1px solid var(--gray-light); background-color: var(--gray-light); }
        .existing-media-item .media-icon-placeholder { font-size: 30px; height: 70px; display: flex; align-items: center; justify-content: center; color: var(--gray-medium); margin-bottom: 0.5rem; }
        .existing-media-item .media-filename { font-weight: 500; margin-bottom: 0.3rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 0.8rem; color: var(--dark); line-height: 1.2; }
        .existing-media-item .media-description { font-size: 0.75rem; color: var(--gray-dark); margin-bottom: 0.5rem; max-height: 2.6em; overflow: hidden; text-overflow: ellipsis; line-height: 1.3em; word-wrap: break-word; }
        .existing-media-item .btn-delete-media { width: auto; align-self: center; margin-top: auto; padding-top: 0.5rem; }
        #uploadMediaFeedback p, #commentsManagementFeedback p { margin: 0; padding: 0.6rem 0.8rem; border-radius: 6px; border: 1px solid transparent; }
        #uploadMediaFeedback p.success-message, #commentsManagementFeedback p.success-message { background-color: rgba(var(--success-rgb), 0.15); border-color: var(--success); color: var(--dark); }
        #uploadMediaFeedback p.error-message, #commentsManagementFeedback p.error-message { background-color: rgba(var(--danger-rgb), 0.15); border-color: var(--danger); color: var(--dark); }
        #manageCommentsModal .comments-list-admin-styled { list-style: none; padding: 0; margin: 0; }
        #manageCommentsModal .comment-item-admin-styled { background: var(--white); border-radius: var(--border-radius-medium); padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: var(--shadow-light); border-left: 4px solid var(--secondary); }
        #manageCommentsModal .comment-item-admin-styled:last-child { margin-bottom: 0; }
        #manageCommentsModal .comment-header { display: flex; align-items: flex-start; gap: 0.8rem; margin-bottom: 0.8rem; }
        #manageCommentsModal .comment-header .user-avatar { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 2px solid var(--gray-light); flex-shrink: 0; }
        #manageCommentsModal .comment-meta strong { font-size: 1rem; color: var(--dark); font-weight: 600; }
        #manageCommentsModal .comment-meta small { font-size: 0.8rem; color: var(--gray-dark); margin-left: 0.5rem; display: block; }
        #manageCommentsModal .comment-meta small.comment-id-details { font-style: italic; font-size: 0.75rem; }
        #manageCommentsModal .comment-text-admin { font-size: 0.95rem; color: var(--dark); line-height: 1.6; margin-bottom: 1rem; word-wrap: break-word; }
        #manageCommentsModal .comment-actions-admin { display: flex; gap: 1rem; align-items: center; margin-top: 0.5rem; padding-top: 0.5rem; border-top: 1px solid var(--gray-light); }
        #manageCommentsModal .btn-admin-reply, #manageCommentsModal .btn-admin-delete-comment { font-size: 0.8rem; padding: 0.4rem 0.8rem; gap: 0.3em; }
        #manageCommentsModal .btn-admin-reply { background-color: var(--secondary); color: white; }
        #manageCommentsModal .btn-admin-reply:hover { background-color: var(--primary); }
        #manageCommentsModal .reply-form-admin { display: none; margin-top: 1rem; margin-left: 50px; padding: 1rem; background-color: var(--light); border-radius: 8px; border: 1px solid var(--gray-light); }
        #manageCommentsModal .reply-form-admin.active { display: block; animation: fadeIn 0.3s ease-out; }
        #manageCommentsModal .reply-form-admin textarea { width: 100%; min-height: 70px; padding: 0.6rem; border: 1px solid var(--gray-medium); border-radius: 6px; font-size: 0.9rem; margin-bottom: 0.5rem; resize: vertical; }
        #manageCommentsModal .reply-form-admin .form-actions-reply { text-align: right; }
        #manageCommentsModal .reply-form-admin .form-message-local { font-size: 0.85rem; margin-top: 0.5rem; text-align: left; }
        #manageCommentsModal .comment-replies-list-styled { list-style: none; padding-left: 0; margin-top: 1rem; margin-left: 25px; border-left: 2px dotted var(--gray-medium); padding-left: 15px; }
        .admin-event-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(360px, 1fr)); gap: 2rem; margin-top: 1.5rem; }
        .admin-event-grid .loading-message-dashboard, .admin-event-grid .error-message-dashboard, .admin-event-grid .no-events-dashboard { grid-column: 1 / -1; text-align: center; padding: 2rem; font-size: 1.1rem; color: var(--gray-dark); background-color: var(--white); border-radius: var(--border-radius-medium); box-shadow: var(--shadow-light); }
        .admin-event-grid .loading-message-dashboard i { margin-right: 0.5em; }
        .admin-event-card { background: var(--white); border-radius: var(--border-radius-medium); box-shadow: var(--shadow-light); border: 1px solid var(--gray-light); display: flex; flex-direction: column; overflow: hidden; transition: var(--transition-medium); }
        .admin-event-card:hover { transform: translateY(-5px); box-shadow: var(--shadow-medium); }
        .admin-event-card-image-container { height: 180px; background-color: var(--gray-light); overflow: hidden; }
        .admin-event-card-image { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease-out; }
        .admin-event-card:hover .admin-event-card-image { transform: scale(1.05); }
        .admin-event-card-content { padding: 1rem 1.2rem; flex-grow: 1; display: flex; flex-direction: column; }
        .admin-event-card-header { margin-bottom: 0.8rem; }
        .admin-event-card-header .admin-event-title { font-size: 1.3rem; color: var(--primary); margin: 0 0 0.3rem 0; font-weight: 600; line-height: 1.4; }
        .admin-event-card-header .admin-event-date { font-size: 0.85rem; color: var(--gray-dark); }
        .admin-event-card-quick-stats { display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.5rem 0.8rem; margin-bottom: 1rem; padding-bottom: 0.8rem; border-bottom: 1px solid var(--gray-light); }
        .admin-event-card-quick-stats .stat-item { font-size: 0.85rem; color: var(--dark); display: flex; align-items: center; background-color: var(--light); padding: 0.3rem 0.5rem; border-radius: 6px; }
        .admin-event-card-quick-stats .stat-item i { margin-right: 0.5em; color: var(--secondary); font-size: 0.9em; width: 16px; text-align: center; }
        .admin-event-card-actions { display: grid; gap: 0.6rem; }
        .admin-event-card-actions .btn-admin { width: 100%; font-size: 0.82rem; padding: 0.5rem 0.55rem; }
        .admin-event-card-actions .btn-admin i { font-size: 0.9em; }
        .admin-event-card-actions.top-actions { grid-template-columns: repeat(3, 1fr); margin-bottom: 0.5rem; }
        .admin-event-card-actions.bottom-actions { grid-template-columns: repeat(3, 1fr); padding-top: 0.5rem; margin-top: 0; border-top: none; }
        .admin-event-card-actions .btn-bookings { background-color: #4CAF50; color: var(--white); border-color: #4CAF50; }
        .admin-event-card-actions .btn-bookings:hover { background-color: #45a049; border-color: #388E3C; }
        .admin-event-card-actions .btn-edit { background-color: var(--accent); color: var(--white); border-color: var(--accent); }
        .admin-event-card-actions .btn-edit:hover { background-color: #b8734a; border-color: #b8734a; }
        .month-year-header { font-size: 1.45rem; color: var(--accent); margin-top: 1.5rem; margin-bottom: 1.2rem; padding-bottom: 0.6rem; border-bottom: 2px solid var(--accent); text-align: left; font-weight: 600; grid-column: 1 / -1 !important; width: 100%; }
        .admin-event-grid > .add-event-btn-container-wrapper + .month-year-header, .admin-event-grid > .month-year-header:first-child { margin-top: 0; } /* Adjusted for new button */
        #manageBookingsModal .modal-content { max-width: 750px; }
        #bookingsListContainerModal .user-booking-group { border: 1px solid var(--gray-light); border-radius: 8px; padding: 0.8rem; margin-bottom: 0.8rem; background-color: #fdfdfd; }
        #bookingsListContainerModal .user-booking-group h5 { font-size: 1.05rem; color: var(--primary); margin-top: 0; margin-bottom: 0.8rem; padding-bottom: 0.5rem; border-bottom: 1px dotted var(--gray-medium); }
        #bookingsListContainerModal .single-booking-details { padding: 0.5rem; margin-bottom: 0.5rem; border-left: 3px solid var(--secondary); background-color: var(--white); }
        #bookingsListContainerModal .single-booking-details > p { font-size: 0.9rem; margin-bottom: 0.3rem; }
        #bookingsListContainerModal .participant-list-inline { list-style: none; padding-left: 0; margin-bottom: 0.5rem; font-size: 0.85rem; }
        #bookingsListContainerModal .participant-list-inline li { display: inline-block; margin-right: 0.8rem; padding: 0.2rem 0.5rem; background-color: var(--light); border-radius: 4px; border: 1px solid var(--gray-light); }
        #bookingsListContainerModal .single-booking-details .btn-admin.btn-sm { display: inline-block; margin-top: 0.5rem; }
        #bookingsManagementFeedbackModal p { margin: 0; padding: 0.6rem 0.8rem; border-radius: 6px; border: 1px solid transparent; font-size: 0.9rem; }
        #bookingsManagementFeedbackModal p.success-message { background-color: rgba(var(--success-rgb), 0.15); border-color: var(--success); color: var(--dark); }
        #bookingsManagementFeedbackModal p.error-message { background-color: rgba(var(--danger-rgb), 0.15); border-color: var(--danger); color: var(--dark); }
        .loading-message-dashboard, .error-message-dashboard, .no-events-dashboard { text-align: center; padding: 2rem; font-size: 1.1rem; color: var(--gray-dark); }
        .admin-event-grid > .no-events-dashboard { grid-column: 1 / -1; }
        .no-events-dashboard a { color: var(--accent); text-decoration: underline; }
        .no-events-dashboard a:hover { color: var(--primary); }
        .badge-admin-dashboard { display: inline-block; margin-left: 0.6em; padding: 0.2em 0.6em; font-size: 0.75em; font-weight: bold; color: var(--white); background-color: var(--primary); border-radius: 4px; line-height: 1.2; vertical-align: middle; text-transform: uppercase; letter-spacing: 0.5px; }
        
        /* === STILE PER BOTTONE "AGGIUNGI EVENTO" (STILE DA eventiincorso.html, adattato per dashboard) === */
        .add-event-btn-container-wrapper {
          width: 100%;
          padding: 0 0 1.5rem 0; /* Meno padding superiore per dashboard */
          display: flex;
          justify-content: center;
          grid-column: 1 / -1 !important; /* Per farlo span su tutta la griglia */
        }
        #adminAddEventBtn { /* ID usato per il bottone che apre il nuovo modal */
          display: inline-flex;
          align-items: center;
          justify-content: center;
          padding: 0.8rem 1.5rem;
          font-size: 1rem;
          font-weight: 500;
          color: var(--success-dark, #155724);
          background-color: var(--white, #fff);
          border: 2px dashed var(--success, #28a745);
          border-radius: var(--border-radius-large, 12px);
          cursor: pointer;
          transition: all 0.2s ease-in-out;
          text-decoration: none;
          width: auto;
          max-width: 400px;
          margin: 0 auto;
        }
        #adminAddEventBtn:hover, #adminAddEventBtn:focus {
          background-color: var(--success-light, #d4edda);
          border-color: var(--success-dark, #155724);
          color: var(--success-dark, #155724);
          box-shadow: 0 4px 12px rgba(var(--success-rgb, 40, 167, 69), 0.2);
          transform: translateY(-2px);
        }
        #adminAddEventBtn:active {
          transform: translateY(0);
          box-shadow: 0 2px 6px rgba(var(--success-rgb, 40, 167, 69), 0.15);
        }
        #adminAddEventBtn .plus-icon {
          font-size: 1.3em;
          margin-right: 0.6em;
          font-weight: bold;
        }

        @media (max-width: 767px) {
            .event-controls-header { flex-direction: column; align-items: stretch; }
            .event-tabs-container-main { width: 100%; margin-bottom: 0; display: grid; grid-template-columns: 1fr 1fr; }
            .event-tabs-container-main .event-tab-button { margin-right: 0; border-radius:0 !important; border-bottom: 1px solid var(--gray-medium); }
            .event-tabs-container-main .event-tab-button:first-child { border-top-left-radius: 10px !important; border-right: 1px solid var(--gray-medium); }
            .event-tabs-container-main .event-tab-button:nth-child(2) { border-top-right-radius: 10px !important; }
            .filter-trigger-container-main { width: 100%; margin-left: 0; }
            .filter-trigger-container-main #filterToggleButton.event-tab-button { width: 100%; justify-content: center; border-radius: 0 0 10px 10px !important; border-left: 1px solid var(--gray-medium) !important; border-right: 1px solid var(--gray-medium) !important; margin-left: 0; }
            .filter-trigger-container-main #filterToggleButton.event-tab-button.active { border-radius:0 !important; border-bottom: none !important; }
            .filter-panel { position: static; width: 100%; box-shadow: none; border-radius: 0 0 10px 10px; border-top: 1px solid var(--gray-medium); margin-bottom: 1rem; }
            .filter-trigger-container-main #filterToggleButton.event-tab-button.active + .filter-panel { border-top: none; }
            .event-view-controls { flex-direction: column; align-items: stretch; border-radius: var(--border-radius-medium); margin-top: 1rem; border: 1px solid var(--gray-medium); }
            #eventManagementContent { border-radius: var(--border-radius-medium); margin-top: 1rem; border: 1px solid var(--gray-medium); }
            .admin-event-grid { grid-template-columns: 1fr; }
            .admin-event-card { max-width: none; min-height: auto; }
            .add-event-btn-container-wrapper { min-height: auto; padding: 1rem; margin-bottom: 1rem; } /* Adjusted for new button */
            #adminAddEventBtn .plus-icon { font-size: 1.5rem; } /* Adjusted for new button */
            #adminAddEventBtn .fab-text-label { font-size: 1.1rem; } /* Adjusted for new button */
            .admin-event-card-actions.top-actions, .admin-event-card-actions.bottom-actions { grid-template-columns: repeat(auto-fit, minmax(85px, 1fr)); }
        }

        .moderation-slider-group { margin-bottom: 1.5rem; padding: 1rem; background-color: #f0f3f5; border-radius: 8px; border: 1px solid #dfe6e9; }
        .moderation-slider-label-container { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.8rem; }
        .moderation-slider-label-container label { font-weight: 600; color: var(--primary); font-size: 1.1rem; margin-bottom: 0; }
        #moderationLevelLabel { font-weight: bold; font-size: 1rem; padding: 0.4em 0.8em; border-radius: 6px; color: var(--white); transition: background-color 0.3s ease, box-shadow 0.3s ease; box-shadow: 0 1px 3px rgba(0,0,0,0.1); min-width: 180px; text-align: center; }
        #moderationLevelLabel.level-0 { background-color: #2ecc71; } 
        #moderationLevelLabel.level-1 { background-color: #f1c40f; color: var(--dark); } 
        #moderationLevelLabel.level-2 { background-color: #e67e22; } 
        #moderationLevelLabel.level-3 { background-color: #e74c3c; } 
        .moderation-slider { -webkit-appearance: none; appearance: none; width: 100%; height: 10px; background: #dfe6e9; border-radius: 5px; outline: none; cursor: pointer; transition: background 0.3s ease; }
        .moderation-slider::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 22px; height: 22px; border-radius: 50%; background: var(--secondary); cursor: pointer; border: 3px solid var(--white); box-shadow: 0 2px 5px rgba(0,0,0,0.25); margin-top: -6px; transition: background-color 0.3s ease, transform 0.15s ease; }
        .moderation-slider:active::-webkit-slider-thumb { transform: scale(1.1); }
        .moderation-slider.level-0::-webkit-slider-thumb { background-color: #2ecc71; }
        .moderation-slider.level-1::-webkit-slider-thumb { background-color: #f1c40f; }
        .moderation-slider.level-2::-webkit-slider-thumb { background-color: #e67e22; }
        .moderation-slider.level-3::-webkit-slider-thumb { background-color: #e74c3c; }
        .moderation-slider::-moz-range-thumb { width: 18px; height: 18px; border-radius: 50%; background: var(--secondary); cursor: pointer; border: 3px solid var(--white); box-shadow: 0 2px 5px rgba(0,0,0,0.25); transition: background-color 0.3s ease, transform 0.15s ease; }
        .moderation-slider:active::-moz-range-thumb { transform: scale(1.1); }
        .moderation-slider.level-0::-moz-range-thumb { background-color: #2ecc71; }
        .moderation-slider.level-1::-moz-range-thumb { background-color: #f1c40f; }
        .moderation-slider.level-2::-moz-range-thumb { background-color: #e67e22; }
        .moderation-slider.level-3::-moz-range-thumb { background-color: #e74c3c; }
        #moderationLevelDescription { font-size: 0.9rem; color: var(--gray-dark); text-align: center; margin-top: 1rem; padding: 0.5rem; background-color: var(--white); border-radius: 6px; border: 1px solid var(--gray-light); min-height: 1.5em; }
        .moderation-preview-container { margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--gray-light); }
        .moderation-preview-container h5 { font-size: 1.2rem; color: var(--primary); margin-bottom: 1.2rem; text-align: center; font-weight: 600; }
        #moderationPreviewChat { background-color: #f0f3f5; border: 1px solid #dfe6e9; border-radius: 8px; padding: 1rem; max-height: 280px; overflow-y: auto; box-shadow: inset 0 2px 4px rgba(0,0,0,0.04); }
        .chat-message-example { position: relative; background-color: var(--white); padding: 0.8rem 1rem; border-radius: 8px; margin-bottom: 0.7rem; border: 1px solid var(--gray-light); font-size: 0.95rem; transition: all 0.3s cubic-bezier(0.25, 0.1, 0.25, 1); overflow: hidden; box-shadow: 0 1px 2px rgba(0,0,0,0.05); min-height: 50px; display: flex; flex-direction: column; justify-content: center; }
        .chat-message-example:last-child { margin-bottom: 0; }
        .chat-message-example .chat-user { font-weight: 700; color: var(--secondary); margin-right: 0.5em; }
        .chat-message-example .chat-text { color: #444; transition: opacity 0.25s ease-out, filter 0.25s ease-out; }
        .chat-message-example .blocked-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(231, 76, 60, 0.08); color: var(--danger); display: flex; flex-direction: column; align-items: center; justify-content: center; border-radius: 8px; opacity: 0; visibility: hidden; transform: translateY(8px) scale(0.97); transition: opacity 0.3s cubic-bezier(0.25, 0.1, 0.25, 1) 0.05s, transform 0.3s cubic-bezier(0.25, 0.1, 0.25, 1) 0.05s, visibility 0s linear 0.35s; pointer-events: none; border: 1px dashed rgba(231, 76, 60, 0.4); padding: 8px; box-sizing: border-box; text-align: center; }
        .chat-message-example.blocked .chat-text { filter: blur(1px); opacity: 0.4; }
        .chat-message-example.blocked .blocked-overlay { opacity: 1; visibility: visible; transform: translateY(0) scale(1); transition-delay: 0s; pointer-events: auto; }
        .blocked-overlay .blocked-icon { font-size: 1.6em; margin-bottom: 0.2em; color: var(--danger); animation: popInBlockedIcon 0.35s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.1s backwards; }
        .blocked-overlay .blocked-text { font-size: 0.8rem; font-weight: 500; line-height: 1.3; word-wrap: break-word; overflow-wrap: break-word; animation: fadeInBlockedText 0.4s ease-out 0.2s backwards; }
        @keyframes popInBlockedIcon { 0% { transform: scale(0.4) rotate(-15deg); opacity: 0; } 70% { transform: scale(1.1) rotate(5deg); opacity: 1; } 100% { transform: scale(1) rotate(0deg); opacity: 1; } }
        @keyframes fadeInBlockedText { 0% { opacity: 0; transform: translateY(3px); } 100% { opacity: 1; transform: translateY(0); } }
        #advancedOptionsModal .form-actions { display: flex; justify-content: flex-end; gap: 0.8rem; margin-top: 2rem; padding-top: 1.2rem; border-top: 1px solid var(--gray-light); }
        #advancedOptionsModal .btn-admin-secondary { background-color: var(--gray-light); color: var(--dark); border-color: var(--gray-medium); }
        #advancedOptionsModal .btn-admin-secondary:hover { background-color: var(--gray-medium); }
        #advancedSettingsModalMessage { margin-top: 1rem; text-align: center; font-size: 0.95rem; }
        .active-filters-display { padding: 1rem; margin-bottom: 1.5rem; background-color: #f0f8ff; border: 1px solid #b0e0e6; border-radius: var(--border-radius-medium); box-shadow: var(--shadow-light); }
        .active-filters-display h4 { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.1rem; color: var(--primary); padding-bottom: 0.5rem; border-bottom: 1px dotted var(--gray-medium); }
        .active-filters-list { list-style: none; padding: 0; margin: 0; display: flex; flex-wrap: wrap; gap: 0.5rem; }
        .active-filters-list li { background-color: var(--secondary); color: var(--white); padding: 0.4rem 0.8rem; border-radius: 6px; font-size: 0.85rem; font-weight: 500; display: inline-flex; align-items: center; }
        .active-filters-list li .filter-label { opacity: 0.8; margin-right: 0.3em; }
        .active-filters-display .no-filters-active { font-style: italic; color: var(--gray-dark); font-size: 0.95rem; }

        /* === STILI PER IL NUOVO POPUP ADMIN (da eventiincorso.html, per creazione/modifica eventi) === */
        .dash-admin-event-popup-overlay {
          position: fixed; top: 0; left: 0; width: 100%; height: 100%;
          background-color: rgba(0,0,0,0.65); z-index: 1050; /* Stesso z-index di .modal */
          display: none; opacity: 0; transition: opacity 0.3s ease;
        }
        .dash-admin-event-popup-overlay.active { display: block; opacity: 1; }

        .dash-admin-event-popup {
          position: fixed; top: 50%; left: 50%;
          background-color: var(--white, #fff);
          padding: 0;
          border-radius: var(--border-radius-large, 12px);
          box-shadow: var(--shadow-strong, 0 10px 30px rgba(0,0,0,0.2));
          z-index: 1051; /* Superiore a .modal e .dash-admin-event-popup-overlay */
          width: 95%; max-width: 900px;
          max-height: 90vh;
          display: none; opacity: 0;
          transform: translate(-50%, -50%) scale(0.95);
          transition: opacity 0.3s ease, transform 0.3s ease;
          overflow: hidden; /* Per contenere header/content */
        }
        .dash-admin-event-popup.active {
          opacity: 1; transform: translate(-50%, -50%) scale(1);
          display: flex; flex-direction: column; /* Per header fisso e content scrollabile */
        }

        .dash-admin-event-popup-header {
          padding: 1rem 1.5rem;
          border-bottom: 1px solid var(--gray-light, #eee);
          display: flex; justify-content: space-between; align-items: center;
          flex-shrink: 0; /* Impedisce al header di restringersi */
        }
        .dash-admin-event-popup-header h2 { margin: 0; color: var(--primary); font-size: 1.5rem; }
        .dash-admin-event-popup .close-popup { /* Stile per il bottone di chiusura specifico del nuovo modal */
          font-size: 1.8rem; color: var(--gray-dark, #777); background: none;
          border: none; cursor: pointer; padding: 0.5rem; line-height: 1;
        }
        .dash-admin-event-popup .close-popup:hover { color: var(--dark, #333); }
        .dash-admin-event-popup-content {
          overflow-y: auto; /* Permette lo scroll solo del contenuto */
          padding: 1.5rem;
          display: flex; /* Per gestire le viste interne */
          flex-direction: column; /* Le viste interne si impilano verticalmente */
          flex-grow: 1; /* Occupa lo spazio rimanente */
        }

        /* === NUOVI STILI PER LA SELEZIONE DELLA MODALITÀ DI CREAZIONE === */
        #creationModeSelectionView {
          display: flex; /* Inizialmente flessibile per le opzioni */
          flex-direction: row; /* Opzioni affiancate */
          align-items: stretch; /* Opzioni alte uguali */
          justify-content: center;
          gap: 1.5rem;
          padding: 2rem 1rem;
          width: 100%;
          flex-grow: 1; /* Occupa spazio nel popup-content */
        }
        .creation-mode-option {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          padding: 1.8rem 1.5rem;
          border: 1px solid var(--gray-light);
          border-radius: var(--border-radius-large);
          background-color: var(--white);
          box-shadow: var(--shadow-light);
          cursor: pointer;
          transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
          width: 100%;
          max-width: 320px;
          text-align: center;
          flex-basis: 0; /* Permette flex-grow di funzionare correttamente */
          flex-grow: 1;
          position: relative;
          overflow: hidden;
        }
        .creation-mode-option:hover {
          transform: translateY(-5px) scale(1.03);
          box-shadow: var(--shadow-medium-strong, 0 8px 25px rgba(0,0,0,0.12));
          border-color: var(--secondary);
        }
        .creation-mode-option .icon-container {
          font-size: 2.5rem;
          color: var(--secondary);
          margin-bottom: 1rem;
          transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
          z-index: 1;
          position: relative; 
          display: flex;
          align-items: center;
          justify-content: center;
          min-height: 40px; 
        }
        .creation-mode-option:hover .icon-container {
          color: var(--primary);
          transform: scale(1.15);
        }
        .ai-logo-text {
          font-size: 0.6em; 
          font-weight: bold;
          line-height: 1.1;
          display: block;
          color: var(--primary);
        }
        .ai-logo-text .line-1 { font-size: 0.9em; display: block; }
        .ai-logo-text .line-2 { font-size: 1.15em; display: block; letter-spacing: 0.5px;}
        .star {
          position: absolute;
          background-color: var(--primary);
          border-radius: 50%;
          opacity: 0;
          animation: twinkle 1.5s infinite ease-in-out;
          width: 3px;
          height: 3px;
        }
        .creation-mode-option#extractFromFlyerModeBtn:hover .star { opacity: 0.7; }
        .star.s1 { top: 10%; left: 15%; animation-delay: 0s; width: 2px; height: 2px;}
        .star.s2 { top: 20%; right: 10%; animation-delay: 0.3s; }
        .star.s3 { bottom: 15%; left: 25%; animation-delay: 0.6s; width: 2px; height: 2px;}
        .star.s4 { bottom: 25%; right: 20%; animation-delay: 0.9s; }
        .star.s5 { top: 50%; left: 5%; animation-delay: 0.2s; }
        .star.s6 { top: 5%; right: 30%; animation-delay: 0.7s; width: 1px; height: 1px;}
        @keyframes twinkle {
          0%, 100% { opacity: 0; transform: scale(0.5); }
          50% { opacity: 1; transform: scale(1.2); }
        }
        .creation-mode-option h4 {
          font-size: 1.25rem;
          color: var(--primary);
          margin-bottom: 0.5rem;
          font-weight: 600;
          text-align: center;
          z-index: 1;
        }
        .creation-mode-option p {
          font-size: 0.9rem;
          color: var(--gray-dark);
          line-height: 1.6;
          margin-bottom: 0;
          text-align: center;
          z-index: 1;
        }
        .creation-mode-option#extractFromFlyerModeBtn {
          border-color: var(--primary-light, #a5c2b9);
          background: linear-gradient(145deg, var(--primary-lighter, #eef3f1), var(--white));
        }
        .creation-mode-option#extractFromFlyerModeBtn::before {
          content: "";
          position: absolute;
          top: 0;
          left: -150%;
          width: 50%;
          height: 100%;
          background: linear-gradient(
                  to right,
                  rgba(255, 255, 255, 0) 0%,
                  rgba(255, 255, 255, 0.3) 50%, 
                  rgba(255, 255, 255, 0) 100%
          );
          transform: skewX(-25deg);
          transition: left 0.85s cubic-bezier(0.25, 0.8, 0.25, 1); 
          z-index: 0;
        }
        .creation-mode-option#extractFromFlyerModeBtn:hover::before {
          left: 150%;
        }
        .creation-mode-option#extractFromFlyerModeBtn:hover {
          border-color: var(--primary);
          box-shadow: 0 10px 30px rgba(var(--primary-rgb), 0.2);
        }
        .creation-mode-option#extractFromFlyerModeBtn:hover .icon-container {
          transform: scale(1.1); 
        }

        /* === NUOVI STILI PER LA SEZIONE CARICAMENTO VOLANTINO === */
        #flyerUploadView {
          display: none; /* Nascosto di default */
          padding: 2rem;
          border: 2px dashed var(--gray-medium);
          border-radius: var(--border-radius-large);
          background-color: var(--background-light, #f8f9fa);
          text-align: center;
          margin-top: 1rem;
          position: relative;
        }
        #flyerUploadView .form-group {
          margin-bottom: 1.5rem;
          display: flex;
          flex-direction: column;
          align-items: center;
        }
        #flyerUploadView .form-group label {
          display: block;
          margin-bottom: 0.8rem;
          color: var(--primary-dark, #333);
          font-weight: 500;
          font-size: 1rem;
          text-align: center;
        }
        #flyerUploadView #flyerFile { /* Input file */
          display: block;
          margin: 0 auto 1.5rem auto;
          max-width: 450px;
          padding: 0.5rem;
          border: 1px solid var(--gray-light);
          border-radius: var(--border-radius-small);
        }
        #flyerUploadView #flyerPreviewContainer {
          position: relative;
          max-width: 100%;
          max-height: 250px;
          margin: 0 auto 1.5rem auto;
          display: none; /* Nascosto finché non c'è un'immagine */
          display: flex; /* Per centrare l'immagine */
          align-items: center;
          justify-content: center;
        }
        #flyerUploadView #flyerPreview { /* Immagine anteprima */
          max-width: 100%;
          max-height: 250px;
          border: 1px solid var(--gray-light);
          border-radius: var(--border-radius-medium);
          display: block;
          box-shadow: var(--shadow-light);
          position: relative;
          z-index: 1;
        }
        #flyerUploadView #flyerPreviewContainer.pulsating-background::before {
          content: '';
          position: absolute;
          top: -8px; left: -8px; right: -8px; bottom: -8px; 
          background-color: rgba(var(--primary-rgb), 0.08); 
          border-radius: calc(var(--border-radius-medium) + 8px);
          animation: flyerPulseEffect 1.8s infinite ease-in-out; 
          z-index: 0;
        }
        @keyframes flyerPulseEffect {
          0%, 100% { opacity: 0.3; transform: scale(1); }
          50% { opacity: 0.8; transform: scale(1.03); }
        }
        #flyerUploadView #processFlyerBtn.btn-popup .spinner-mini { /* Bottone Processa */
          margin-right: 8px;
        }
        #flyerProcessingStatus { /* Messaggio di stato */
          margin-top: 1rem;
          font-size: 0.9rem;
          min-height: 1.2em;
        }
        #flyerProcessingStatus.error { color: var(--danger); }
        #flyerProcessingStatus.success { color: var(--success); }

        /* === STILI PER IL FORM MANUALE E ANTEPRIMA CARD (dentro il nuovo popup) === */
        .dash-admin-event-form-and-preview-container {
          display: none; /* Nascosto di default, mostrato dopo selezione modalità */
          flex-wrap: wrap; gap: 2rem;
        }
        #dashAdminEventForm { flex: 2; min-width: 320px; }
        #dashAdminEventCardPreviewContainer {
          flex: 1; min-width: 280px; padding: 1rem; border: 1px dashed var(--gray-medium, #ccc);
          border-radius: var(--border-radius-medium, 8px); background-color: var(--background-light, #f8f9fa);
          height: fit-content; position: sticky; top: 1.5rem; /* Sticky per desktop */
        }
        @media (max-width: 768px) { /* Su mobile, l'anteprima va sotto */
          .dash-admin-event-form-and-preview-container { flex-direction: column-reverse; }
          #dashAdminEventCardPreviewContainer { position: static; margin-bottom: 2rem;}
        }
        #dashAdminEventCardPreviewContainer h4 {
          text-align: center; color: var(--primary); margin-top: 0; margin-bottom: 1rem;
          font-size: 1.1rem; border-bottom: 1px solid var(--gray-light, #eee); padding-bottom: 0.5rem;
        }
        .dash-admin-preview-card { /* Card di anteprima */
          background: var(--white); border-radius: var(--border-radius-medium);
          box-shadow: var(--shadow-light); overflow: hidden; border: 1px solid var(--gray-light);
        }
        .dash-admin-preview-card-image-container {
          height: 160px; background-color: var(--gray-lighter, #f0f0f0); display: flex;
          align-items: center; justify-content: center; overflow: hidden;
        }
        .dash-admin-preview-card-image-container img { width: 100%; height: 100%; object-fit: cover; }
        .dash-admin-preview-card-image-container .dash-admin-no-image-placeholder { font-size: 0.9rem; color: var(--gray-dark); }
        .dash-admin-preview-card-content { padding: 0.8rem 1rem; }
        .dash-admin-preview-card-content h5 { /* Titolo anteprima */
          font-size: 1.15rem; color: var(--primary); margin: 0 0 0.4rem 0;
          font-weight: 600; min-height: 1.2em; word-break: break-word;
        }
        .dash-admin-preview-card-content p { /* Paragrafi anteprima */
          font-size: 0.85rem; color: var(--gray-dark); line-height: 1.4;
          margin-bottom: 0.4rem; min-height: 1em; word-break: break-word;
        }
        .dash-admin-preview-card-content .dash-admin-preview-relatore { font-style: italic; }
        .dash-admin-preview-card-content .dash-admin-preview-posti,
        .dash-admin-preview-card-content .dash-admin-preview-costo { font-weight: bold; }
        
        /* Stili per il form dashAdminEventForm */
        #dashAdminEventForm .form-group { margin-bottom: 1rem; position: relative; }
        #dashAdminEventForm .form-group label {
          display: block; margin-bottom: 0.3rem; color: var(--primary-dark, #333);
          font-weight: 500; font-size: 0.9rem;
        }
        #dashAdminEventForm .form-control, #dashAdminEventForm select.form-control {
          width: 100%; padding: 0.7rem 0.9rem; border: 1px solid var(--gray-medium, #ccc);
          border-radius: 6px; font-size: 0.95rem; background-color: var(--white, #fff);
          transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }
        #dashAdminEventForm .form-control:focus {
          border-color: var(--secondary, #8db187);
          box-shadow: 0 0 0 2px rgba(var(--secondary-rgb, 141, 177, 135), 0.2);
          outline: none;
        }
        #dashAdminEventForm textarea.form-control { min-height: 70px; resize: vertical; }
        #dashAdminEventForm .form-grid {
          display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem;
        }
        #dashAdminEventForm .form-check-group {
          display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;
        }
        #dashAdminEventForm .form-check-group input[type="checkbox"] {
          width: auto; margin-right: 0.2rem; transform: scale(1.05);
        }
        #dashAdminEventForm .form-check-group label {
          font-weight: normal; font-size: 0.9rem; margin-bottom: 0; color: var(--dark);
        }
        #dashAdminEventForm .form-actions { margin-top: 1.5rem; text-align: right; }
        #dashAdminEventForm .form-actions .btn-popup { /* Bottone Salva Evento */
            padding: 0.8rem 1.5rem; 
            background-color: var(--primary); 
            color: var(--white);
            border: none;
            border-radius: var(--border-radius-medium);
        }
        #dashAdminEventForm .form-actions .btn-popup:hover {
            background-color: var(--primary-dark);
        }
        #dashAdminEventForm small { /* Testo piccolo sotto gli input */
          font-size: 0.8rem; color: var(--gray-dark); display: block; margin-top: 0.2rem;
        }
        #dashAdmin-current-event-image-preview { /* Anteprima immagine esistente */
          margin-top: 0.5rem; max-width: 120px; border: 1px solid var(--gray-light, #eee);
          padding: 4px; border-radius: 4px; display:none;
        }
        #dashAdmin-current-event-flyer-preview { /* Info volantino esistente */
          margin-top: 0.5rem; padding: 4px; font-size: 0.85rem;
        }
        #dashAdmin-current-event-flyer-preview a { color: var(--primary); text-decoration: underline; }
        #dashAdmin-current-event-flyer-preview span { color: var(--gray-dark); }
        #dashAdminEventFormMessage.form-message { margin-top: 1rem; }

        /* === NUOVI STILI PER BOTTONE AI "DYNAMIC ISLAND" (da eventiincorso.html) === */
        .ai-generate-btn-container { /* Contenitore per posizionare il bottone AI */
          position: relative;
        }
        .ai-generate-btn { /* Bottone AI stesso */
          position: absolute;
          top: -11px; /* Posizionamento sopra e a destra del label */
          right: 0px;
          background-color: var(--primary);
          color: white;
          border: none;
          border-radius: 19px; /* Arrotondato */
          min-width: 38px; /* Larghezza minima per icona */
          height: 38px;
          padding: 0 9px;
          font-size: 1.05rem; /* Icona leggermente più grande */
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: 0 4px 12px rgba(0,0,0,0.1), 0 1px 3px rgba(0,0,0,0.08);
          z-index: 10; /* Sopra altri elementi del form */
          opacity: 0; /* Inizialmente invisibile */
          transform: scale(0.7) translateY(15px); /* Per animazione entrata */
          pointer-events: none; /* Non cliccabile se invisibile */
          overflow: hidden; /* Per animazione testo */
          transition: opacity 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275),
          transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275),
          min-width 0.35s ease-in-out, /* Animazione espansione */
          padding 0.35s ease-in-out,
          background-color 0.2s ease;
        }
        .ai-generate-btn::before { /* Effetto cosmico */
          content: '';
          position: absolute;
          top: -50%; left: -50%;
          width: 200%; height: 200%;
          border-radius: inherit;
          background-image:
                  radial-gradient(circle at 25% 25%, rgba(255,255,255,0.15) 0px, transparent 2px),
                  radial-gradient(circle at 75% 15%, rgba(200,200,255,0.12) 0.5px, transparent 2.5px),
                  radial-gradient(circle at 50% 75%, rgba(220,220,255,0.1) 1px, transparent 3px),
                  radial-gradient(circle at 15% 85%, rgba(230,230,255,0.13) 0.5px, transparent 2px),
                  radial-gradient(circle at 85% 60%, rgba(210,210,255,0.11) 0.75px, transparent 2.5px);
          background-size: 50px 50px;
          opacity: 0;
          mix-blend-mode: screen;
          transition: opacity 0.5s ease-in-out;
          animation: cosmicFlow 20s linear infinite;
          z-index: 0;
          will-change: transform, background-position;
        }
        @keyframes cosmicFlow {
          0% { background-position: 0% 0%; transform: rotate(0deg) scale(1); }
          100% { background-position: 200px 200px; transform: rotate(360deg) scale(1.1); }
        }
        .ai-generate-btn.visible { /* Quando appare (es. se c'è testo nella descr. lunga) */
          opacity: 1;
          transform: scale(1) translateY(0);
          pointer-events: auto;
          animation: aiButtonPulseMain 2.8s infinite cubic-bezier(0.45, 0.05, 0.55, 0.95) 0.6s;
        }
        .ai-generate-btn.visible::before { opacity: 0.5; }
        .ai-generate-btn.visible.expanded { /* Quando si espande per mostrare il testo */
          min-width: 170px; /* Larghezza per contenere "Genera con AI" */
          padding: 0 14px;
        }
        .ai-generate-btn:not(.loading):hover {
          background-color: var(--secondary);
          transform: scale(1.05) translateY(0);
          box-shadow: 0 6px 15px rgba(0,0,0,0.15);
          animation-play-state: paused; /* Ferma animazione pulse su hover */
        }
        .ai-generate-btn:not(.loading):hover::before {
          animation-play-state: paused;
          opacity: 0.7;
        }
        .ai-generate-btn:not(.loading):active {
          transform: scale(0.98) translateY(0);
          background-color: var(--primary-dark, #2a4b40);
        }
        @keyframes aiButtonPulseMain {
          0%, 100% { box-shadow: 0 4px 12px rgba(var(--primary-rgb, 54,94,81),0.1), 0 1px 3px rgba(0,0,0,0.08); transform: scale(1) translateY(0); }
          50% { box-shadow: 0 7px 18px rgba(var(--primary-rgb, 54,94,81),0.18), 0 3px 7px rgba(0,0,0,0.12); transform: scale(1.02) translateY(0); }
        }
        .ai-btn-content-wrapper { /* Contenitore per icona e testo */
          display: flex; align-items: center; justify-content: center;
          width: 100%; height: 100%; position: relative; z-index: 2;
        }
        .ai-icon { display: inline-block; transition: opacity 0.2s ease, transform 0.3s ease; margin-right: 0; }
        .ai-text { /* Testo "Genera con AI" */
          opacity: 0; max-width: 0; overflow: hidden; white-space: nowrap;
          font-size: 0.85rem;
          font-weight: 500; margin-left: 0.4em;
          transition: opacity 0.3s ease-in-out 0.1s, max-width 0.35s ease-in-out 0.05s;
        }
        .ai-generate-btn.visible.expanded .ai-text {
          opacity: 1;
          max-width: 140px; /* Abbastanza per il testo */
        }
        .ai-ripple-container { /* Per effetto ripple */
          position: absolute; top: 0; left: 0; right: 0; bottom: 0;
          border-radius: inherit; overflow: hidden; z-index: 1;
        }
        .ai-ripple-container::before,
        .ai-ripple-container::after {
          content: ''; position: absolute; left: 50%; top: 50%;
          transform: translate(-50%, -50%) scale(0);
          border-radius: 50%;
          background-color: rgba(var(--secondary-rgb, 141, 177, 135), 0.15);
          opacity: 0; pointer-events: none;
        }
        .ai-generate-btn.visible:not(.loading):not(:hover) .ai-ripple-container::before {
          width: 180%; height: 180%;
          animation: rippleWave 2.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) infinite 0s;
        }
        .ai-generate-btn.visible:not(.loading):not(:hover) .ai-ripple-container::after {
          width: 180%; height: 180%;
          animation: rippleWave 2.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) infinite 0.9s;
        }
        .ai-generate-btn:hover .ai-ripple-container::before,
        .ai-generate-btn:hover .ai-ripple-container::after {
          animation-play-state: paused; /* Ferma ripple su hover */
        }
        @keyframes rippleWave {
          0% { transform: translate(-50%, -50%) scale(0.1); opacity: 0.6; }
          70% { transform: translate(-50%, -50%) scale(1.3); opacity: 0.15; }
          100% { transform: translate(-50%, -50%) scale(1.8); opacity: 0; }
        }
        .ai-spinner-container { /* Contenitore per spinner e testo "Genero..." */
            display: none; align-items: center; justify-content: center; 
        }
        .ai-spinner-container .spinner-mini { /* Spinner specifico per AI button */
          width: 0.9em; height: 0.9em; border-width: 2px;
          border-top-color: var(--white);
          border-left-color: rgba(255,255,255,0.3);
          border-right-color: rgba(255,255,255,0.3);
          border-bottom-color: rgba(255,255,255,0.3);
          margin: 0;
        }
        .ai-spinner-container .ai-loading-text { font-size: 0.8rem; font-weight: 500; color: white; margin-left: 8px; }
        .ai-generate-btn.loading { /* Stato di caricamento */
          min-width: 120px; /* Larghezza per "Genero..." */
          padding: 0 14px;
          background-color: var(--secondary); /* Cambia colore durante il caricamento */
          animation-play-state: paused; /* Ferma pulse */
          cursor: default;
        }
        .ai-generate-btn.loading::before { /* Nasconde effetto cosmico */
          opacity: 0 !important;
          animation: none !important;
        }
        .ai-generate-btn.loading .ai-btn-content-wrapper { display: none; } /* Nasconde icona/testo normale */
        .ai-generate-btn.loading .ai-spinner-container { display: flex; } /* Mostra spinner */
        .ai-generate-btn.loading .ai-ripple-container::before,
        .ai-generate-btn.loading .ai-ripple-container::after {
          animation: none; opacity: 0; /* Ferma ripple */
        }
        #aiShortDescStatus { /* Messaggio di stato sotto la textarea della descr. breve */
            font-size: 0.75rem; color: var(--gray-dark); display: block; margin-top: 2px; height: 1em;
        }

        /* === STILI NUOVO POPUP VOLANTINO (Design Ispirato Apple, da eventiincorso.html) === */
        :root { /* Definisce variabili specifiche per questo modal, se necessario */
          --flyer-text-primary: #1d1d1f;
          --flyer-modal-bg: #f8f8fa; /* Sfondo modal leggermente diverso */
          --flyer-overlay-bg: rgba(0, 0, 0, 0.65); /* Overlay più scuro */
        }
        .flyer-overlay-eff { /* Overlay per il popup del volantino */
          position: fixed;
          top: 0; left: 0; width: 100%; height: 100%;
          background-color: var(--flyer-overlay-bg);
          backdrop-filter: blur(16px) saturate(160%); /* Effetto vetro smerigliato */
          -webkit-backdrop-filter: blur(16px) saturate(160%);
          z-index: 2000; /* Molto alto per essere sopra tutto */
          display: flex; align-items: center; justify-content: center;
          opacity: 0; visibility: hidden; /* Inizialmente nascosto */
          transition: opacity 0.4s cubic-bezier(0.45, 0.05, 0.55, 0.95), visibility 0s linear 0.4s;
        }
        .flyer-overlay-eff.active { /* Quando attivo */
          opacity: 1; visibility: visible;
          transition-delay: 0s;
        }
        .flyer-modal-eff { /* Contenitore del volantino */
          background-color: var(--flyer-modal-bg);
          border-radius: 22px; /* Angoli arrotondati stile Apple */
          box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25), 0 0 15px rgba(0, 0, 0, 0.1);
          width: clamp(320px, 88vw, 1000px); /* Larghezza responsiva */
          height: clamp(450px, 85vh, 750px); /* Altezza responsiva */
          display: flex; flex-direction: column;
          position: relative;
          opacity: 0; transform: scale(0.92) translateY(15px); /* Animazione entrata */
          transition: opacity 0.4s cubic-bezier(0.45, 0.05, 0.55, 0.95) 0.05s, transform 0.4s cubic-bezier(0.45, 0.05, 0.55, 0.95) 0.05s;
          overflow: hidden; /* Per angoli arrotondati e contenuto */
        }
        .flyer-overlay-eff.active .flyer-modal-eff { /* Quando attivo */
          opacity: 1; transform: scale(1) translateY(0px);
        }
        .flyer-close-btn-eff { /* Bottone chiusura volantino */
          position: absolute; top: 8px; right: 12px;
          font-size: 2rem; color: var(--gray-dark, #777); background: none;
          border: none; cursor: pointer; padding: 0.5rem; line-height: 1;
          z-index: 10; /* Sopra il contenuto del volantino */
          transition: color 0.2s ease, transform 0.25s ease-out;
        }
        .flyer-close-btn-eff:hover, .flyer-close-btn-eff:focus-visible {
          color: var(--dark, #333); transform: rotate(90deg); background: none;
        }
        .flyer-content-area-eff { /* Area che contiene l'immagine/pdf */
          flex-grow: 1; width: 100%; height: 100%;
          overflow: hidden; display: flex; align-items: center; justify-content: center;
          border-radius: inherit; /* Mantiene gli angoli arrotondati del parent */
        }
        .flyer-media-container-eff { /* Contenitore diretto dell'immagine/pdf */
          width: 100%; height: 100%; overflow: auto; /* Scroll se il contenuto è più grande */
          display: flex; align-items: center; justify-content: center;
          padding: 5px; box-sizing: border-box;
        }
        .flyer-media-container-eff img, .flyer-media-container-eff iframe {
          display: block; max-width: 100%; max-height: 100%;
          width: auto; height: auto; object-fit: contain; /* Adatta mantenendo proporzioni */
          border: none; border-radius: 8px; /* Angoli arrotondati per il media stesso */
        }
        .flyer-media-container-eff iframe { /* Specifico per PDF */
          width: 100%; height: 100%; min-height: 400px;
        }
        .flyer-message-display-eff { /* Per messaggi (es. volantino non trovato) */
          text-align: center; padding: 3rem 1rem; font-size: 1.1rem;
          color: var(--flyer-text-primary); display: flex; flex-direction: column;
          align-items: center; justify-content: center; width: 100%; height: 100%;
        }
        .flyer-message-display-eff p { margin-bottom: 1rem; }
        .flyer-message-display-eff a {
          color: var(--primary); text-decoration: underline; font-weight: 500;
          padding: 0.6rem 1.2rem; background-color: rgba(0,0,0,0.05); border-radius: 8px;
        }
        .flyer-message-display-eff a:hover { background-color: rgba(0,0,0,0.08); }
        body.flyer-popup-active-eff { overflow: hidden; } /* Blocca scroll pagina principale */

        /* === STILI PER CUSTOM CONFIRM MODAL (da eventiincorso.html) === */
        .custom-confirm-overlay {
          position: fixed; top: 0; left: 0; width: 100%; height: 100%;
          background-color: rgba(0,0,0,0.6);
          z-index: 2000; /* Sopra il popup del volantino, se necessario */
          display: none; align-items: center; justify-content: center;
          opacity: 0; transition: opacity 0.2s ease-out;
        }
        .custom-confirm-overlay.active { display: flex; opacity: 1; }
        .custom-confirm-modal {
          background-color: var(--white); padding: 2rem;
          border-radius: var(--border-radius-medium);
          box-shadow: var(--shadow-strong);
          width: 90%; max-width: 450px;
          text-align: center;
          transform: scale(0.95); opacity: 0; /* Animazione entrata */
          transition: transform 0.2s ease-out, opacity 0.2s ease-out;
        }
        .custom-confirm-overlay.active .custom-confirm-modal {
          transform: scale(1); opacity: 1;
        }
        .custom-confirm-modal h3 {
          font-size: 1.3rem; color: var(--primary);
          margin-top: 0; margin-bottom: 1rem;
        }
        .custom-confirm-modal p {
          font-size: 1rem; color: var(--gray-dark);
          margin-bottom: 1.5rem; line-height: 1.6;
        }
        .custom-confirm-actions {
          display: flex; justify-content: center; gap: 1rem;
        }
        .custom-confirm-actions .btn-popup { /* Usa la classe btn-popup per coerenza */
          min-width: 100px;
          padding: 0.7rem 1.2rem; /* Leggermente più piccolo del btn-popup standard */
          font-size: 0.9rem;
        }
        .custom-confirm-actions .btn-confirm-no { /* Bottone Annulla/No */
          background-color: var(--gray-light);
          color: var(--dark);
          border: 1px solid var(--gray-medium);
        }
        .custom-confirm-actions .btn-confirm-no:hover {
          background-color: var(--gray-medium);
        }
        .custom-confirm-actions .btn-confirm-yes { /* Bottone Conferma/Sì */
            background-color: var(--primary); /* Usa colore primario per conferma */
            color: var(--white);
        }
        .custom-confirm-actions .btn-confirm-yes:hover {
            background-color: var(--primary-dark);
        }
        /* === STILI PER INFO A "PILLOLE" (adattato per dashboard) === */
.card-info-pills {
    display: flex;
    flex-wrap: wrap;
    gap: 0.6rem;
    margin-bottom: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--gray-light);
}
.info-pill {
    display: inline-flex;
    align-items: center;
    background-color: var(--light);
    color: var(--dark);
    padding: 0.3rem 0.8rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 500;
    border: 1px solid var(--gray-light);
}
.info-pill i {
    margin-right: 0.5rem;
    color: var(--secondary);
    font-size: 0.9em;
}

    </style>
</head>
<body class="page-dashboard">

<header class="navbar-container" id="navbarContainer">
    <nav class="navbar">
        <div class="logo">
  <a href="index.html">
    <img src="images/Logo_eremo.png" alt="Logo Eremo frate Francesco" class="navbar-logo-img" id="navbarLogoImgTag">
    <h2 id="navbar-title-admin">Eremo frate Francesco - Admin</h2>
  </a>
</div>
    </nav>
    </header>

<main class="dashboard-main">
    <h1><i class="fas fa-tachometer-alt"></i> Admin Dashboard</h1>

    <div style="text-align: right; margin-bottom: 1.5rem;">
        <button id="openAdvancedOptionsModalBtn" class="btn-admin btn-admin-info">
            <i class="fas fa-cogs"></i> Opzioni Avanzate
        </button>
    </div>

    <div class="event-controls-header">
        <div class="event-tabs-container-main">
            <button class="event-tab-button active" data-tab="upcoming"><i class="fas fa-calendar-day"></i> Eventi Futuri</button>
            <button class="event-tab-button" data-tab="past"><i class="fas fa-history"></i> Archivio Eventi</button>
        </div>
        <div class="filter-trigger-container-main">
            <button id="filterToggleButton" class="event-tab-button filter-tab-button" aria-expanded="false" aria-controls="filterPanelDropdown">
                <i class="fas fa-filter"></i> Filtri <span class="dropdown-arrow-filter">▼</span>
            </button>
            <div id="filterPanelDropdown" class="filter-panel" role="region">
                <h4>Applica Filtri</h4>
                <div class="form-group">
                    <label for="searchTitleDashboard">Titolo Evento</label>
                    <input type="text" id="searchTitleDashboard" placeholder="Cerca per titolo..." class="form-control">
                </div>
                <div class="form-group">
                    <label for="searchDateDashboard">Mese/Anno (YYYY-MM)</label>
                    <input type="month" id="searchDateDashboard" class="form-control">
                </div>
                <div class="form-group">
                    <label for="searchSpeakerDashboard">Relatore</label>
                    <input type="text" id="searchSpeakerDashboard" class="form-control" placeholder="Nome relatore...">
                </div>
                <div class="filter-panel-actions">
                    <button type="button" class="btn-admin btn-admin-secondary" id="applyFiltersFromPanelBtn">Applica</button>
                    <button type="button" class="btn-admin" id="resetFiltersBtnPanel" title="Resetta filtri">
                        <i class="fas fa-times"></i> Reset
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="event-view-controls">
        <div class="form-group sorting-group">
            <label for="sortCriteria">Ordina per:</label>
            <select id="sortCriteria" class="form-control">
                <option value="mese" selected>Data Evento</option>
                <option value="titolo">Titolo Evento</option>
                <option value="relatore">Relatore</option>
                <option value="prenotazioni">N. Prenotazioni</option>
                <option value="post_occupati">Posti Occupati</option>
                <option value="post_tot">Posti Totali</option>
            </select>
        </div>
        <div class="form-group sorting-group">
            <label for="sortDirection">Direzione:</label>
            <select id="sortDirection" class="form-control">
                <option value="asc" selected>Crescente</option>
                <option value="desc">Decrescente</option>
            </select>
        </div>
        <div class="form-group grouping-group">
            <label for="groupCriteria">Raggruppa per:</label>
            <select id="groupCriteria" class="form-control">
                <option value="mese" selected>Mese e Anno</option>
                <option value="giorno">Giorno</option>
                <option value="settimana">Settimana</option>
                <option value="anno">Anno</option>
                <option value="relatore">Relatore</option>
                <option value="nessuno">Nessun raggruppamento</option>
            </select>
        </div>
    </div>

    <div id="activeFiltersDisplayContainer" class="active-filters-display" style="display: none;">
        <h4>Filtri Attivi:</h4>
        <ul id="activeFiltersList" class="active-filters-list">
        </ul>
    </div>

    <div id="eventManagementContent" class="dashboard-section">
        <div class="add-event-btn-container-wrapper">
            <button id="adminAddEventBtn" aria-label="Aggiungi Nuovo Evento">
                <span class="plus-icon">+</span>
                <span class="fab-text-label">Aggiungi Nuovo Evento</span>
            </button>
        </div>

        <div class="event-tab-content active" id="upcomingEventsContainer">
            <div id="upcomingEventsGrid" class="admin-event-grid">
                <p class="loading-message-dashboard"><i class="fas fa-spinner fa-spin"></i> Caricamento eventi futuri...</p>
            </div>
        </div>
        <div class="event-tab-content" id="pastEventsContainer" style="display: none;">
            <div id="pastEventsGrid" class="admin-event-grid">
                <p class="loading-message-dashboard"><i class="fas fa-spinner fa-spin"></i> Caricamento archivio eventi...</p>
            </div>
        </div>
    </div>
</main>

<div id="advancedOptionsModal" class="modal">
    <div class="modal-content" style="max-width: 700px;">
        <span class="close-modal-btn" data-modal-id="advancedOptionsModal">&times;</span>
        <h3><i class="fas fa-user-shield"></i> Impostazioni Moderazione Commenti</h3>
        <div class="modal-content-scrollable">
            <div class="moderation-slider-group">
                <div class="moderation-slider-label-container">
                    <label for="moderationLevelSliderInput">Livello Filtro IA:</label>
                    <span id="moderationLevelLabel" class="slider-level-label">Moderazione Standard</span>
                </div>
                <input type="range" id="moderationLevelSliderInput" class="moderation-slider" min="0" max="3" value="2" step="1">
                <p id="moderationLevelDescription" class="slider-level-description">Descrizione livello...</p>
            </div>
            <div class="moderation-preview-container">
                <h5><i class="fas fa-comments"></i> Anteprima Effetto Moderazione</h5>
                <div id="moderationPreviewChat">
                </div>
            </div>
        </div>
        <div class="form-actions">
            <button type="button" class="btn-admin btn-admin-secondary close-modal-btn-alt" data-modal-id="advancedOptionsModal">Annulla</button>
            <button type="button" class="btn-admin btn-admin-primary" id="saveAdvancedSettingsModalBtn"><i class="fas fa-save"></i> Salva Impostazioni</button>
        </div>
        <div id="advancedSettingsModalMessage" class="form-message" style="display:none;"></div>
    </div>
</div>

<div id="uploadMediaModal" class="modal">
    <div class="modal-content">
        <span class="close-modal-btn" data-modal-id="uploadMediaModal">&times;</span>
        <h3>Gestisci Media per Evento: <span id="uploadMediaEventTitle"></span></h3>
        <div class="modal-content-scrollable">
            <h4>Carica Nuovi Media</h4>
            <form id="uploadMediaForm" class="media-upload-form">
                <input type="hidden" id="uploadMediaEventId" name="eventId">
                <div class="form-group"><label for="mediaFiles">Seleziona File:</label><input type="file" id="mediaFiles" name="mediaFiles[]" multiple accept="image/*,video/*,.pdf"></div>
                <div class="form-group"><label for="mediaDescription">Descrizione (opzionale):</label><textarea id="mediaDescription" name="description" rows="3" placeholder="Breve descrizione del media..."></textarea></div>
                <button type="submit" class="btn-admin btn-admin-secondary"><i class="fas fa-upload"></i> Carica</button>
            </form>
            <div id="uploadMediaFeedback" style="margin-top:1rem;"></div>
            <div class="existing-media-section"><h4>Media Esistenti</h4><div id="existingMediaContainer"><p>Nessun media.</p></div></div>
        </div>
    </div>
</div>

<div id="manageCommentsModal" class="modal">
    <div class="modal-content">
        <span class="close-modal-btn" data-modal-id="manageCommentsModal">&times;</span>
        <h3>Gestisci Commenti: <span id="commentsEventTitle"></span></h3>
        <div class="modal-content-scrollable">
            <ul id="commentsListContainer" class="comments-list-admin-styled">
                <li><p><i class="fas fa-spinner fa-spin"></i> Caricamento commenti...</p></li>
            </ul>
        </div>
        <div id="commentsManagementFeedback" style="margin-top:1rem;"></div>
    </div>
</div>

<div id="manageBookingsModal" class="modal">
    <div class="modal-content">
        <span class="close-modal-btn" data-modal-id="manageBookingsModal">&times;</span>
        <h3>Gestisci Prenotazioni: <span id="bookingsEventTitle"></span></h3>
        <div class="modal-content-scrollable" id="bookingsListContainerModal">
            <p><i class="fas fa-spinner fa-spin"></i> Caricamento prenotazioni...</p>
        </div>
        <div id="bookingsManagementFeedbackModal" style="margin-top:1rem;"></div>
    </div>
</div>


<div class="dash-admin-event-popup-overlay" id="dashAdminEventPopupOverlay"></div>
<div class="dash-admin-event-popup" id="dashAdminEventPopup">
  <div class="dash-admin-event-popup-header">
    <h2 id="dashAdminEventPopupTitle">Aggiungi Nuovo Evento</h2>
    <button class="close-popup" id="closeDashAdminEventPopupBtn" aria-label="Chiudi popup">&times;</button>
  </div>
  <div class="dash-admin-event-popup-content">
    <div id="creationModeSelectionView">
      <div class="creation-mode-option" id="createManuallyModeBtn">
        <div class="icon-container"><i class="fas fa-edit"></i></div>
        <h4>Crea Manualmente</h4>
        <p>Inserisci tutti i dettagli dell'evento compilando il modulo.</p>
      </div>
      <div class="creation-mode-option" id="extractFromFlyerModeBtn">
        <div class="icon-container">
                <span class="ai-logo-text">
                    <span class="line-1">Eremo</span>
                    <span class="line-2">Vision AI</span>
                </span>
          <span class="star s1"></span><span class="star s2"></span><span class="star s3"></span>
          <span class="star s4"></span><span class="star s5"></span><span class="star s6"></span>
        </div>
        <h4>Estrai da Volantino</h4>
        <p>Carica un volantino e lascia che l'AI compili i campi per te.</p>
      </div>
    </div>

    <div id="flyerUploadView">
      <h4>Carica Volantino Evento</h4>
      <div class="form-group">
        <label for="flyerFile">Seleziona immagine volantino (JPG, PNG, WEBP):</label>
        <input type="file" id="flyerFile" class="form-control" accept="image/jpeg, image/png, image/webp">
      </div>
      <div id="flyerPreviewContainer">
        <img id="flyerPreview" src="#" alt="Anteprima Volantino" />
      </div>
      <button type="button" id="processFlyerBtn" class="btn-popup" disabled><i class="fas fa-cogs"></i> Processa Volantino con AI</button>
      <div id="flyerProcessingStatus"></div>
    </div>

    <div class="dash-admin-event-form-and-preview-container">
      <form id="dashAdminEventForm" method="POST" enctype="multipart/form-data">
        <input type="hidden" id="dashAdmin-event-id" name="event-id">

        <div class="form-group">
          <label for="dashAdmin-event-title">Titolo Evento*</label>
          <input type="text" id="dashAdmin-event-title" name="event-title" class="form-control" required>
        </div>

        <div class="form-group">
          <label for="dashAdmin-event-date">Data Inizio*</label>
          <input type="date" id="dashAdmin-event-date" name="event-date" class="form-control" required>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label for="dashAdmin-event-start-time">Orario Inizio (HH:MM)</label>
            <input type="time" id="dashAdmin-event-start-time" name="event-start-time" class="form-control">
          </div>
          <div class="form-group">
            <label for="dashAdmin-event-end-time">Orario Fine (HH:MM)</label>
            <input type="time" id="dashAdmin-event-end-time" name="event-end-time" class="form-control">
          </div>
        </div>

        <div class="form-group">
          <label for="dashAdmin-event-long-desc">Descrizione Estesa</label>
          <textarea id="dashAdmin-event-long-desc" name="event-long-desc" class="form-control" rows="4"></textarea>
        </div>

        <div class="form-group ai-generate-btn-container">
          <label for="dashAdmin-event-short-desc">Descrizione Breve* (max 200 caratteri)</label>
          <button type="button" id="generateShortDescBtn" class="ai-generate-btn" title="Genera descrizione breve con AI">
            <span class="ai-btn-content-wrapper">
                <span class="ai-icon">✨</span>
                <span class="ai-text">Genera con AI</span>
            </span>
            <span class="ai-ripple-container"></span>
            <span class="ai-spinner-container">
                <span class="spinner-mini"></span>
                <span class="ai-loading-text">Genero...</span>
            </span>
          </button>
          <textarea id="dashAdmin-event-short-desc" name="event-short-desc" class="form-control" rows="2" required maxlength="200"></textarea>
          <small id="aiShortDescStatus" style="font-size: 0.75rem; color: var(--gray-dark); display: block; margin-top: 2px; height: 1em;"></small>
        </div>


        <div class="form-grid">
          <div class="form-group">
            <label for="dashAdmin-event-prefix">Prefisso Relatore</label>
            <input type="text" id="dashAdmin-event-prefix" name="event-prefix" class="form-control" placeholder="Default: Relatore">
          </div>
          <div class="form-group">
            <label for="dashAdmin-event-speaker">Nome Relatore*</label>
            <input type="text" id="dashAdmin-event-speaker" name="event-speaker" class="form-control" required>
          </div>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label for="dashAdmin-event-association">Associazione</label>
            <input type="text" id="dashAdmin-event-association" name="event-association" class="form-control">
          </div>
          <div class="form-group">
            <label for="dashAdmin-event-seats">Posti Disponibili Iniziali*</label>
            <input type="number" id="dashAdmin-event-seats" name="event-seats" class="form-control" required min="0">
          </div>
        </div>

        <div class="form-group">
          <label for="dashAdmin-event-image">Immagine Copertina</label>
          <input type="file" id="dashAdmin-event-image" name="event-image" class="form-control" accept="image/*">
          <small>Lascia vuoto se non vuoi modificare l'immagine esistente.</small>
          <img id="dashAdmin-current-event-image-preview" src="#" alt="Anteprima Immagine">
        </div>

        <div class="form-group">
          <label for="dashAdmin-event-flyer">Volantino (PDF/Immagine)</label>
          <input type="file" id="dashAdmin-event-flyer" name="event-flyer" class="form-control" accept="image/*,application/pdf">
          <small>Lascia vuoto se non vuoi modificare il volantino esistente.</small>
          <div id="dashAdmin-current-event-flyer-preview">
          </div>
        </div>

        <div class="form-check-group">
          <input type="checkbox" id="dashAdmin-event-booking" name="event-booking" checked>
          <label for="dashAdmin-event-booking">Prenotazioni aperte</label>
        </div>

        <div class="form-check-group">
          <input type="checkbox" id="dashAdmin-event-voluntary" name="event-voluntary">
          <label for="dashAdmin-event-voluntary">Offerta libera</label>
        </div>

        <div class="form-group" id="dashAdmin-event-price-container" style="display: block;">
          <label for="dashAdmin-event-price">Prezzo (€)</label>
          <input type="number" id="dashAdmin-event-price" name="event-price" class="form-control" min="0" step="0.01" placeholder="Es. 10.00">
        </div>

        <div id="dashAdminEventFormMessage" class="form-message" style="display:none;"></div>
        <div class="form-actions">
          <button type="submit" class="btn-popup">Salva Evento</button>
        </div>
      </form>

      <div id="dashAdminEventCardPreviewContainer">
        <h4>Anteprima Card Evento</h4>
        <div class="dash-admin-preview-card">
          <div class="dash-admin-preview-card-image-container">
            <img id="dashAdmin_previewImage" src="images/default-event.jpg" alt="Anteprima copertina evento">
            <span class="dash-admin-no-image-placeholder" style="display:none;">Nessuna immagine</span>
          </div>
          <div class="dash-admin-preview-card-content">
            <h5 id="dashAdmin_previewTitle">Titolo Evento</h5>
            <p id="dashAdmin_previewDateFull"><b>Data:</b> <span class="value">Seleziona data</span></p>
            <p id="dashAdmin_previewTimeFull" style="display:none;"><b>Orario:</b> <span class="value"></span></p>
            <p id="dashAdmin_previewSpeakerFull" class="dash-admin-preview-relatore"><b><span id="dashAdmin_previewSpeakerPrefix">Relatore</span>:</b> <span id="dashAdmin_previewSpeakerName" class="value">Nome Relatore</span></p>
            <p id="dashAdmin_previewShortDesc">Descrizione breve dell'evento qui...</p>
            <p id="dashAdmin_previewSeatsFull" class="dash-admin-preview-posti"><b>Posti:</b> <span class="value">0</span></p>
            <p id="dashAdmin_previewPriceFull" class="dash-admin-preview-costo"><b>Costo:</b> <span class="value">€ 0.00</span></p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="flyer-overlay-eff" id="globalFlyerOverlayEff">
    </div>

<div class="custom-confirm-overlay" id="customConfirmOverlay">
  <div class="custom-confirm-modal" id="customConfirmModal">
    <h3>Conferma Azione</h3>
    <p id="customConfirmMessage">Sei sicuro di voler procedere?</p>
    <div class="custom-confirm-actions">
      <button type="button" class="btn-popup btn-confirm-no" id="customConfirmNo">Annulla</button>
      <button type="button" class="btn-popup btn-confirm-yes" id="customConfirmYes">Conferma</button>
    </div>
  </div>
</div>


<footer >
  <p>© <span id="currentYear"></span> Eremo frate Francesco. OdV Via San Vito 2, Nembro. C.F.:90004060167. Sviluppato da 5AII 2024-2025 Majorana Seriate.</p>
</footer>

<script src="dashboard.js" defer></script>
</body>
</html>
