<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="images/logo.png" type="image/x-icon" />
    <title>Privacy Policy - Eremo Frate Francesco</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Roboto:wght@300;400;500;700&family=Segoe+UI:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Stili popup login/registrazione */
        .login-popup input.form-control { transition: border-color 0.3s ease; border: 1px solid #ced4da; background-color: white !important; box-shadow: none !important; outline: none !important; }
        .login-popup input.error-border { border-color: var(--danger, red) !important; }

        /* Aggiunti dal blocco style di index.html per coerenza */
        .login-popup input.form-control {
            transition: border-color 0.3s ease;
            border: 1px solid #ced4da;
            background-color: white !important;
            box-shadow: none !important;
        }

        .login-popup input.error-border {
            border-color: red !important;
        }

        /* Nuova regola per la spaziatura dei paragrafi */
        main p {
            margin-bottom: 1em; /* Aggiungi spazio sotto ogni paragrafo */
        }
    </style>
</head>
<body>
    <header class="navbar-container" id="navbarContainer">
        <nav class="navbar">
            <div class="logo">
                <a href="index.html"><span class="emoji">üèîÔ∏è</span><h2>Eremo Frate Francesco</h2></a>
            </div>
            <div class="menu">
                <a href="eventiincorso.html">Calendario attivit√†</a>
                <a href="eventipassati.html">Archivio attivit√†</a><span class="separator">|</span>
                <a href="incontrisullaparola.html">Incontri sulla parola</a><span class="separator">|</span>
                <a href="dovesiamo.html">Dove siamo</a>
                <a href="contatti.html">Contatti</a>
            </div>
            <div class="right-menu">
                <button id="login-btn" class="login-btn">Accedi</button>
                <button class="hamburger" onclick="toggleMobileMenu()" aria-label="Toggle menu">‚ò∞</button>
            </div>
        </nav>
        <div class="mobile-menu" id="mobileMenu">
            <a href="eventiincorso.html" onclick="closeMobileMenu()">Calendario attivit√†</a>
            <a href="eventipassati.html" onclick="closeMobileMenu()">Archivio attivit√†</a>
            <a href="incontrisullaparola.html" onclick="closeMobileMenu()">Incontri sulla parola</a>
            <a href="dovesiamo.html" onclick="closeMobileMenu()">Dove siamo</a>
            <a href="contatti.html" onclick="closeMobileMenu()">Contatti</a>
            <a href="#" id="login-btn-mobile" onclick="openLoginPopup(); closeMobileMenu();">Accedi</a>
        </div>
    </header>

    <main>
        <div class="container section-padding pb-0">
            <h1>Privacy Policy</h1>
        </div>
        <div class="container section-padding pt-0 text-content-centered">
            <h2>Titolare del Trattamento dei Dati</h2>
            <p>Il Titolare del trattamento dei vostri dati personali √®: Lorem Ipsum</p>
            <p>
                <strong>Eremo Frate Francesco</strong><br>
                Via della Spiritualit√† 123, Nembro (BG), Italia<br>
                info.eremofrancesco@email.it<br>
                +39 0987654321
            </p>
            <p>Per qualsiasi domanda o richiesta relativa alla presente Privacy Policy o al trattamento dei vostri dati, potete contattarci ai recapiti sopra indicati.</p>

            <h2>Tipologie di Dati Raccolti</h2>
            <p>Raccogliamo diverse tipologie di dati personali, a seconda delle finalit√† e dei servizi offerti:</p>
            <ul>
                <li><strong>Dati di identificazione e contatto:</strong> nome, cognome, indirizzo email.</li>
                <li><strong>Dati di immagine e audio/video:</strong> come indicato nei <a href="termini.html">Termini e Condizioni</a>, la vostra immagine e/o voce potrebbero essere riprese durante gli eventi e utilizzate per scopi promozionali e di archivio.</li>
            </ul>

            <h2>Finalit√† del Trattamento</h2>
            <p>I vostri dati personali sono raccolti e trattati per le seguenti finalit√†:</p>
            <ul>
                <li><strong>Gestione delle iscrizioni e partecipazione agli eventi:</strong> per consentire di registrarsi e prendere parte agli eventi.</li>
                <li><strong>Comunicazioni relative agli eventi:</strong> aggiornamenti su posti liberati quando si √® in coda o modifiche sui termini e condizioni.</li>
                <li><strong>Adempimento di obblighi legali e regolamentari:</strong> per rispettare leggi, regolamenti, ordini di autorit√†.</li>
                <li><strong>Scopi di marketing e divulgazione:</strong> utilizzo di immagini e video per promuovere le attivit√† dell'Eremo.</li>
            </ul>

            <h2>Base Giuridica del Trattamento</h2>
            <p>Il trattamento dei vostri dati personali si basa sulle seguenti condizioni:</p>
            <ul>
                <li><strong>Esecuzione di un contratto:</strong> [Dettagli, es. per gestire la vostra partecipazione agli eventi].</li>
                <li><strong>Adempimento di un obbligo legale:</strong> [Dettagli, es. requisiti fiscali o normativi].</li>
                <li><strong>Consenso dell'interessato:</strong> [Dettagli, es. per l'invio di newsletter, per l'utilizzo di immagini e video]. Potete revocare il vostro consenso in qualsiasi momento.</li>
                <li><strong>Legittimo interesse:</strong> [Dettagli, es. per migliorare i nostri servizi, prevenire frodi, salvo prevalenza dei vostri diritti].</li>
            </ul>

            <h2>Modalit√† del Trattamento</h2>
            <p>I vostri dati sono trattati con strumenti manuali e informatici, adottando misure di sicurezza adeguate a prevenire la loss dei dati, usi illeciti o non corretti e accessi non autorizzati.</p>

            <h2>Destinatari dei Dati</h2>
            <p>I vostri dati personali potranno essere comunicati a:</p>
            <ul>
                <li>Personale autorizzato dell'Eremo Frate Francesco.</li>
                <li>Fornitori di servizi esterni (es. hosting, servizi di invio email, analisi dati) che agiscono come Responsabili del trattamento.</li>
                <li>Autorit√† giudiziarie o amministrative, in adempimento di obblighi legali.</li>
            </ul>

            <h2>Trasferimento Dati Extra-UE</h2>
            <p>Il trattamento dei vostri dati non prevede il trasferimento al di fuori dell'Unione Europea. Qualora ci√≤ dovesse rendersi necessario in futuro, avverr√† nel rispetto delle disposizioni del GDPR (Capo V), adottando garanzie adeguate (es. clausole contrattuali standard, decisioni di adeguatezza).</p>

            <h2>Periodo di Conservazione dei Dati</h2>
            <p>I vostri dati personali verranno conservati per il tempo strettamente necessario a perseguire le finalit√† per cui sono stati raccolti, o per periodi pi√π lunghi in caso di obblighi legali (es. contabili, fiscali) o per la tutela dei diritti dell'Eremo in sede giudiziaria.</p>

            <h2>I Vostri Diritti</h2>
            <p>In qualit√† di interessati, avete il diritto di:</p>
            <ul>
                <li>Accedere ai vostri dati personali.</li>
                <li>Ottenere la rettifica dei dati inesatti.</li>
                <li>Chiedere la cancellazione dei dati (diritto all'oblio).</li>
                <li>Ottenere la limitazione del trattamento.</li>
                <li>Ricevere i dati in un formato strutturato, di uso comune e leggibile (diritto alla portabilit√†).</li>
                <li>Opporvi al trattamento.</li>
                <li>Revocare il consenso in qualsiasi momento, senza pregiudicare la liceit√† del trattamento basata sul consenso prima della revoca.</li>
                <li>Proporre reclamo a un'autorit√† di controllo (es. Garante per la Protezione dei Dati Personali).</li>
            </ul>
            <p>Per esercitare tali diritti, potete contattarci ai recapiti indicati al punto 1.</p>

            <h2>Modifiche alla Presente Privacy Policy</h2>
            <p>La presente Privacy Policy potr√† essere aggiornata periodicamente. Ogni qualvolta verr√† effettuata qualche modifica, verr√† inviata a tutti una mail di avviso. L'uso continuato del sito dopo la pubblicazione di modifiche costituir√† accettazione delle stesse.</p>
        </div>
    </main>

    <div class="login-popup-overlay" id="loginOverlay"></div>
    <div class="login-popup" id="loginPopup">
      <button class="close-popup" id="closePopup" aria-label="Chiudi popup">&times;</button>
      <div class="login-tabs">
        <div class="login-tab active" data-tab="login">Accedi</div>
        <div class="login-tab" data-tab="register">Registrati</div>
      </div>
      <form class="login-form active" id="loginForm" method="POST"> <div class="form-group mb-3">
        <label for="login-email">Email</label>
        <input type="email" id="login-email" name="login-email" class="form-control" required autocomplete="email"> </div>
        <div class="form-group mb-3">
          <label for="login-password">Password</label>
          <input type="password" id="login-password" name="login-password" class="form-control" required autocomplete="current-password"> </div>
        <div class="form-actions">
          <button type="submit" class="btn-popup">Accedi</button>
        </div>
      </form>
      <form class="login-form" id="registerForm" method="POST">
        <div class="form-group mb-3">
          <label for="register-name">Nome</label>
          <input type="text" id="register-name" name="register-name" class="form-control" required autocomplete="given-name"> </div>
        <div class="form-group mb-3">
          <label for="register-surname">Cognome</label>
          <input type="text" id="register-surname" name="register-surname" class="form-control" required autocomplete="family-name"> </div>
        <div class="form-group mb-3">
          <label for="register-email">Email</label>
          <input type="email" id="register-email" name="register-email" class="form-control" required autocomplete="email"> </div>
        <div class="form-group mb-3">
          <label for="register-password">Password</label>
          <input type="password" id="register-password" name="register-password" class="form-control" required minlength="8" autocomplete="new-password"> <small>Minimo 8 caratteri.</small>
        </div>
        <div class="terms-checkbox mb-3">
          <input type="checkbox" id="register-terms" name="register-terms" required> <label for="register-terms">Accetto i <a href="/termini.html" target="_blank">termini e condizioni</a></label>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn-popup">Registrati</button>
        </div>
      </form>
    </div>

    <footer>
      <p>¬© 2025 Eremo Frate Francesco. Tutti i diritti riservati. Via della Spiritualit√† 123, Nembro (BG) - Italia</p>
    </footer>

    <script>
      // --- Navbar Scroll Logic ---
      let lastScroll = 0;
      const navbarContainer = document.getElementById('navbarContainer');
      window.addEventListener('scroll', function() {
        const currentScroll = window.pageYOffset || document.documentElement.scrollTop;
        if (currentScroll <= 50) { // Buffer aggiunto
          navbarContainer.classList.remove('hidden');
          lastScroll = 0;
          return;
        }
        if (currentScroll > lastScroll && !navbarContainer.classList.contains('hidden')) {
          // Scroll Down
          navbarContainer.classList.add('hidden');
        } else if (currentScroll < lastScroll && navbarContainer.classList.contains('hidden')) {
          // Scroll Up
          navbarContainer.classList.remove('hidden');
        }
        lastScroll = currentScroll;
      }, false);

      // --- Mobile Menu Logic ---
      const mobileMenu = document.getElementById("mobileMenu");
      const hamburger = document.querySelector(".hamburger");
      function toggleMobileMenu() {
        const isOpen = mobileMenu.classList.toggle("open");
        hamburger.setAttribute("aria-expanded", isOpen);
        document.body.style.overflow = isOpen ? 'hidden' : ''; // Blocca/sblocca scroll
      }
      function closeMobileMenu() {
        mobileMenu.classList.remove("open");
        hamburger.setAttribute("aria-expanded", "false");
        document.body.style.overflow = '';
      }
      // Chiudi menu cliccando fuori
      document.addEventListener('click', function(event) {
        if (mobileMenu.classList.contains('open') &&
                !mobileMenu.contains(event.target) &&
                !hamburger.contains(event.target)) {
          closeMobileMenu();
        }
      });

    // --- Resetta l'errore quando l'utente scrive ---
    document.getElementById('login-email')?.addEventListener('input', resetLoginError);
    document.getElementById('login-password')?.addEventListener('input', resetLoginError);

    // --- Opzionale: Resetta anche al click sul campo ---
    document.getElementById('login-email')?.addEventListener('focus', resetLoginError);
    document.getElementById('login-password')?.addEventListener('focus', resetLoginError);

      // --- Login Popup Logic ---
      const loginBtn = document.getElementById('login-btn');
      const loginBtnMobile = document.getElementById('login-btn-mobile');
      const loginOverlay = document.getElementById('loginOverlay');
      const loginPopup = document.getElementById('loginPopup');
      const closePopupBtn = document.getElementById('closePopup');
      const loginTabs = document.querySelectorAll('.login-tab');
      const loginForms = document.querySelectorAll('.login-form');

      function openLoginPopup() {
        loginOverlay.classList.add('active');
        loginPopup.classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      function closeLoginPopup() {
        loginOverlay.classList.remove('active');
        loginPopup.classList.remove('active');
        document.body.style.overflow = '';
      }

      if (loginBtn) {
        loginBtn.addEventListener('click', (e) => {
          e.preventDefault();
          openLoginPopup();
        });
      }
      if (loginBtnMobile) {
        loginBtnMobile.addEventListener('click', (e) => {
          e.preventDefault();
          closeMobileMenu();
          openLoginPopup();
        });
      }

      if(closePopupBtn) { closePopupBtn.addEventListener('click', closeLoginPopup); }
      if(loginOverlay) { loginOverlay.addEventListener('click', closeLoginPopup); }

      // Login Tabs Switch
      loginTabs.forEach(tab => {
        tab.addEventListener('click', () => {
          const tabId = tab.getAttribute('data-tab');
          loginTabs.forEach(t => t.classList.remove('active'));
          tab.classList.add('active');
          loginForms.forEach(form => {
            form.classList.remove('active');
            if (form.id === `${tabId}Form`) {
              form.classList.add('active');
            }
          });
        });
      });

      // --- Gestione Invio Form con Fetch API ---

    // LOGIN
    document.getElementById('loginForm')?.addEventListener('submit', async (e) => {
        e.preventDefault();
        const loginButton = e.target.querySelector('button[type="submit"]');
        const originalButtonText = loginButton.innerHTML;
        loginButton.disabled = true;
        loginButton.innerHTML = 'Accesso...';

        // Ottieni riferimenti agli input
        const emailInput = document.getElementById('login-email');
        const passwordInput = document.getElementById('login-password');

        // Rimuovi eventuali classi di errore precedenti
        emailInput.classList.remove('error-border');
        passwordInput.classList.remove('error-border');

        try {
            const response = await fetch('login.php', {
                method: 'POST',
                body: new FormData(e.target)
            });

            if (!response.ok) throw new Error(`Errore HTTP: ${response.status}`);

            const result = await response.json();

            if (result.success) {
                closeLoginPopup();
                window.location.href = result.is_admin ? 'indexadmin.html' : 'indexaccesso.html';
            } else {
                // Aggiungi classe di errore
                emailInput.classList.add('error-border');
                passwordInput.classList.add('error-border');
            }
        } catch (error) {
            emailInput.classList.add('error-border');
            passwordInput.classList.add('error-border');
            console.error("Errore login:", error);
        } finally {
            loginButton.disabled = false;
            loginButton.innerHTML = originalButtonText;
        }
    });

      // REGISTRAZIONE
      document.getElementById('registerForm')?.addEventListener('submit', async (e) => {
        e.preventDefault();
        const registerButton = e.target.querySelector('button[type="submit"]');
        const originalButtonText = registerButton.innerHTML;
        registerButton.disabled = true;
        registerButton.innerHTML = 'Registrazione...'; // Feedback visivo

        try {
          const response = await fetch('registrati.php', { // Assicurati che 'registrati.php' sia corretto
            method: 'POST',
            body: new FormData(e.target)
          });

          if (!response.ok) {
            let errorMsg = `Errore HTTP: ${response.status} ${response.statusText}`;
            try {
              const errorData = await response.json();
              errorMsg = errorData.message || errorMsg;
            } catch(e) { /* Ignora se il corpo non √® JSON */ }
            throw new Error(errorMsg);
          }

          const result = await response.json();

          if (result.success) {
            alert(result.message || "Registrazione completata con successo!");
            closeLoginPopup();
            // Potresti voler effettuare il login automatico qui o reindirizzare alla pagina di login
            // openLoginPopup(); // Riapri per login?
            // document.querySelector('.login-tab[data-tab="login"]').click(); // Seleziona tab login
          } else {
            alert("Errore Registrazione: " + (result.message || "Si √® verificato un errore."));
          }
        } catch (error) {
          alert("Errore durante la registrazione: " + error.message);
          console.error("Dettaglio errore registrazione:", error);
        } finally {
          registerButton.disabled = false;
          registerButton.innerHTML = originalButtonText;
        }
      });

      // Chiudi popup con tasto Esc
      document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape' && loginPopup.classList.contains('active')) {
          closeLoginPopup();
        }
      });

    const setupInputReset = (id) => {
        const input = document.getElementById(id);
        if (input) {
            input.addEventListener('input', function() {
                this.classList.remove('error-border');
            });
        }
    };

    function resetLoginError() {
        const emailInput = document.getElementById('login-email');
        const passwordInput = document.getElementById('login-password');
        const errorMessage = document.getElementById('login-error');

        if (emailInput) emailInput.classList.remove('error-border');
        if (passwordInput) passwordInput.classList.remove('error-border');
        if (errorMessage) errorMessage.style.display = 'none';
    }

    document.getElementById('loginForm')?.addEventListener('submit', async (e) => {
        e.preventDefault();
    });

    // Chiama la funzione per entrambi i campi
    setupInputReset('login-email');
    setupInputReset('login-password');
    </script>
</body>
</html>